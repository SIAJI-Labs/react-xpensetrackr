import{j as e,r as s,e as p,a as $}from"./app-0ff37107.js";import{u as D,B as u}from"./button-a5a722b8.js";import{T as q}from"./TemplateList-b56afc36.js";import{T as B}from"./TemplateNoData-1088f1d4.js";import{S as K}from"./SystemLayout-5bf3bc13.js";import{C as U,b as H,c as M,e as z,a as G,d as J}from"./card-1bd90e8f.js";import{I as O}from"./input-d03631fe.js";import{S as o}from"./skeleton-a108b8f6.js";import"./function-a0a83c3b.js";import"./badge-9a3fd840.js";import"./ApplicationLogo-9a435e93.js";import"./ApplicationLogoMask-d548810d.js";import"./textarea-2184d8d3.js";function Q(){let x=(Math.random()+1).toString(36).substring(7);return e.jsx("section",{children:e.jsxs("div",{className:" flex flex-col gap-2 border rounded p-4",children:[e.jsxs("div",{className:" flex flex-row justify-between",children:[e.jsx(o,{className:"w-[100px] h-[20px] rounded-full"}),e.jsxs("div",{className:" flex flex-row gap-2",children:[e.jsx(o,{className:"w-[75px] h-[20px] rounded-full"}),e.jsx(o,{className:"w-[10px] h-[20px] rounded-full"})]})]}),e.jsxs("div",{className:" flex flex-row gap-4 items-center",children:[e.jsx("div",{className:"",children:e.jsx(o,{className:"w-[50px] h-[50px] rounded-full"})}),e.jsxs("div",{className:" flex flex-col gap-2",children:[e.jsx(o,{className:"w-[150px] h-[15px] rounded-full"}),e.jsx(o,{className:"w-[75px] h-[10px] rounded-full"})]})]}),e.jsxs("div",{className:" flex flex-row gap-4",children:[e.jsx(o,{className:"w-[50px] h-[20px] rounded-full"}),e.jsx(o,{className:"w-[50px] h-[20px] rounded-full"}),e.jsx(o,{className:"w-[50px] h-[20px] rounded-full"})]})]})},x)}function de({auth:x}){const S=D(),b=t=>e.jsx(q,{record:t});let R=e.jsx(Q,{});const[m,y]=s.useState(""),[L,V]=s.useState("complete");s.useEffect(()=>{if(!S){const t=setTimeout(()=>{N(f),i()},500);return()=>{clearTimeout(t)}}},[m]);let f=5;const[j,E]=s.useState(0),[g,T]=s.useState(0),[h,N]=s.useState(f),[k,v]=s.useState(!1);s.useEffect(()=>{i()},[h]);const[I,C]=s.useState(!0),[F,A]=s.useState(5),[a,P]=s.useState([]),[c,w]=s.useState(null);s.useEffect(()=>{A(a.length>0?a.length:3)},[a]);const i=async()=>{c instanceof AbortController&&c.abort();const t=new AbortController;w(t),C(!0);const l=[],d={limit:h,filter_status:L,keyword:m};for(const r in d)l.push(encodeURIComponent(r)+"="+encodeURIComponent(d[r]));try{let n=(await p.get(`${route("api.record.v1.list")}?${l.join("&")}`,{cancelToken:new p.CancelToken(function(_){t.abort=_})})).data;P(n.result.data),v(n.result.has_more),E(n.result.data.length),"total"in n.result&&T(n.result.total),C(!1),w(null)}catch(r){p.isCancel(r)?console.log("Request was canceled",r):console.error("Error:",r)}};return s.useEffect(()=>{const t=()=>{setTimeout(()=>{i()},100)};return document.addEventListener("dialog.record.hidden",t),document.addEventListener("record.deleted-action",t),()=>{document.removeEventListener("dialog.record.hidden",t),document.removeEventListener("record.deleted-action",t)}}),e.jsx(e.Fragment,{children:e.jsxs(K,{user:x.user,header:e.jsx("h2",{className:"font-semibold text-xl text-gray-800 leading-tight",children:"Record List"}),children:[e.jsx($,{title:"Record List"}),e.jsx("div",{className:"flex flex-col gap-6",children:e.jsxs(U,{className:"",children:[e.jsx(H,{children:e.jsxs("div",{className:" flex flex-row justify-between items-start",children:[e.jsxs("div",{children:[e.jsx(M,{children:e.jsx("div",{children:"Record: List"})}),e.jsx(z,{children:"See your latest transaction"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[(()=>e.jsx(u,{variant:"outline",onClick:()=>{c instanceof AbortController&&c.abort(),i()},children:e.jsx("i",{className:"fa-solid fa-rotate-right"})}))(),e.jsx(u,{variant:"outline",onClick:()=>{document.dispatchEvent(new CustomEvent("record.edit-action",{bubbles:!0}))},children:e.jsx("i",{className:"fa-solid fa-plus"})})]})]})}),e.jsxs(G,{className:" flex flex-col gap-6",children:[e.jsxs("div",{className:" flex flex-row gap-4",children:[e.jsx(O,{placeholder:"Search by record notes",value:m,onChange:t=>{y(t.target.value)}}),e.jsx(u,{children:e.jsx("i",{className:"fa-solid fa-filter"})})]}),e.jsx("div",{className:" flex flex-col gap-4",children:(()=>{if(I){let t=[];for(let l=0;l<F;l++)t.push(e.jsx("div",{children:R},`skeleton-${l}`));return t}else{let t=[],l=e.jsx(B,{});return a.length>0&&a.map((d,r)=>{t.push(e.jsx("div",{children:b(d)},`record_item-${r}`))}),t.length>0?t:l}})()})]}),e.jsxs(J,{className:"flex justify-between items-center",children:[e.jsx(u,{variant:"outline",className:"",disabled:!k,onClick:()=>{v(!1),N(h+f)},children:"Load more"}),(()=>j>0&&g>0?e.jsx(e.Fragment,{children:e.jsxs("span",{className:"text-sm",children:["Showing ",j," of ",g," entries"]})}):e.jsx(e.Fragment,{}))()]})]})})]})})}export{de as default};
