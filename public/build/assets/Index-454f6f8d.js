import{r as n,j as e,a as k,e as y,y as D}from"./app-49e19f09.js";import{a as S,C as I}from"./index-961138f1.js";import{T as H}from"./TemplateBackButton-a1494aed.js";import{E as L}from"./ErrorMessage-9da431ff.js";import{S as P}from"./SystemLayout-a53fff85.js";import{P as R,a as O,b as $,C as F,c as U,S as V,d as q,e as G,f as _}from"./scroll-area-8438057d.js";import{C as J,a as K}from"./card-2c105230.js";import{B as m}from"./button-8f2a595a.js";import{C as Q}from"./theme-toggle-66897dc1.js";/* empty css            */import"./index-61f18b0c.js";/* empty css              */import"./index-84c40666.js";import"./dialog-dd6b0ada.js";import"./drawer-134f179f.js";import"./TemplateNoData-b0444318.js";import"./input-d9c06e18.js";import"./ApplicationLogoMask-c668ea73.js";import"./ApplicationLogo-c5ad270c.js";function be({auth:c,server:d,preference:r,list:T}){const[a,f]=n.useState(r),E=()=>{f(r)},[o,u]=n.useState({}),[x,p]=n.useState(null),B=t=>{t.preventDefault();let l=document.getElementById("timezone-submit");l&&(l.tagName.toLowerCase()==="button"&&l.setAttribute("disabled","disabled"),l.innerHTML='<span class=" flex items-center gap-1"><i class="fa-solid fa-spinner fa-spin-pulse"></i>Loading</span>'),u({}),x instanceof AbortController&&x.abort();const j=new AbortController;p(j);let i=new FormData;i.append("_method","PUT"),i.append("action","timezone-preference"),i.append("timezone",a??"");let Y=route("api.profile.v1.update",c.user.uuid);y.post(Y,i,{cancelToken:new y.CancelToken(function(g){j.abort=g})}).then(s=>{s.status===200&&D.reload({only:["server","preference"]})}).catch(s=>{var v;let C=(v=s.response)==null?void 0:v.data;C.errors&&u(C.errors),setTimeout(()=>{const z=document.querySelectorAll("#preference-timezone .form--group.is--invalid");z.length>0&&Array.from(z).reduce((N,w)=>N.offsetTop>w.offsetTop?w:N).scrollIntoView({behavior:"smooth"})},100)}).finally(()=>{p(null);let s=document.getElementById("timezone-submit");s&&(s.tagName.toLowerCase()==="button"&&s.removeAttribute("disabled"),s.innerHTML="Submit")})},[A,h]=n.useState(!1),[b,M]=n.useState(new Date);return n.useEffect(()=>{setInterval(()=>{M(new Date)},1e3)}),e.jsxs(P,{user:c.user,header:e.jsx("h2",{className:"font-semibold text-xl text-gray-800 leading-tight",children:"Timezone"}),children:[e.jsx(k,{title:"Timezone"}),e.jsx(H,{className:"px-0"}),e.jsx(J,{children:e.jsx(K,{className:" p-6",children:e.jsxs("form",{onSubmit:B,id:"preference-timezone",className:" flex flex-col gap-4",children:[e.jsxs("div",{className:" p-4 rounded bg-gray-100 flex flex-col gap-2",children:[e.jsxs("div",{className:" flex flex-col gap-1 leading-tight",children:[e.jsxs("span",{className:" font-medium",children:["Server time (",d,")"]}),e.jsx("span",{className:" leading-none",children:S(b).tz(d).format("Do MMM, YYYY / HH:mm:ss")})]}),e.jsxs("div",{className:" flex flex-col gap-1 leading-tight",children:[e.jsxs("span",{className:" font-medium",children:["Your time (",r,")"]}),e.jsx("span",{className:" leading-none",children:S(b).tz(r).format("Do MMM, YYYY / HH:mm:ss")})]})]}),e.jsxs("div",{className:" flex flex-col gap-2",children:[e.jsxs("div",{className:" form--group",children:[e.jsx("label",{className:" form--label",children:"Select your Timezone"}),e.jsxs("div",{children:[e.jsxs(R,{open:A,onOpenChange:h,children:[e.jsx(O,{asChild:!0,children:e.jsxs(m,{variant:"outline",role:"combobox",className:`w-full justify-between ${o!=null&&o.timezone?" !border-red-500":""} dark:text-white`,children:[e.jsx("span",{className:" whitespace-nowrap overflow-hidden w-full text-ellipsis text-left font-light",children:a&&a!==""?a:"Select Timezone"}),e.jsx(Q,{className:"ml-2 h-4 w-4 shrink-0 opacity-50"})]})}),e.jsx($,{className:" w-[300px] lg:w-[400px] p-0",align:"start",children:e.jsxs(F,{children:[e.jsx(U,{placeholder:"Search Timezone",className:" border-none focus:ring-0"}),e.jsx(V,{className:"p-0",children:e.jsxs("div",{className:"max-h-[10rem]",children:[e.jsx(q,{children:"No timezone found."}),e.jsx(G,{children:T.map(t=>e.jsxs(_,{value:t==null?void 0:t.tzCode,onSelect:l=>{f(t.tzCode===a?void 0:t.tzCode),h(!1)},children:[e.jsx(I,{className:`mr-2 h-4 w-4 ${a===(t==null?void 0:t.tzCode)?"opacity-100":"opacity-0"}`}),e.jsx("span",{className:" w-full overflow-hidden whitespace-nowrap text-ellipsis",children:`${t==null?void 0:t.tzCode}`})]},t==null?void 0:t.tzCode))})]})})]})})]}),e.jsx(L,{message:o==null?void 0:o.timezone})]})]}),e.jsxs("div",{className:" flex flex-row gap-2 justify-end",children:[e.jsx(m,{type:"button",variant:"outline",onClick:()=>{E()},disabled:a===r,children:"Reset"}),e.jsx(m,{type:"button",onClick:()=>{document.getElementById("preference-timezone")&&document.getElementById("preference-timezone").dispatchEvent(new Event("submit",{bubbles:!0}))},id:"timezone-submit",disabled:a===r,children:"Submit"})]})]})]})})})]})}export{be as default};
