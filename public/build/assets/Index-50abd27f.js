import{j as e,r as n,d as A,e as C,a as $}from"./app-0fb84f29.js";import{B as w,u as O}from"./button-7d36141d.js";import{S as r}from"./skeleton-30b488fa.js";import{f as y,h as T}from"./check-dc7caa4e.js";import{D as q,a as _,b as K,c as S,T as P}from"./TemplateNoData-9477a2f9.js";import{S as U}from"./SystemLayout-982f5e01.js";import{C as z,b as G,c as J,d as Q,a as V,e as W}from"./card-8095fa71.js";import{I as X}from"./input-15576a35.js";/* empty css            */import"./index-895c1018.js";/* empty css              */import"./ApplicationLogo-add1b60b.js";import"./scroll-area-f9cd86d1.js";import"./theme-toggle-2a55f5cc.js";import"./ApplicationLogoMask-fa62c2fd.js";function Z(){let s=(Math.random()+1).toString(36).substring(7);return e.jsx("section",{children:e.jsxs("div",{className:" flex flex-col gap-2 border rounded p-4",children:[e.jsxs("div",{className:" flex flex-row justify-between",children:[e.jsx(r,{className:"w-[100px] h-[20px] rounded-full"}),e.jsxs("div",{className:" flex flex-row gap-2",children:[e.jsx(r,{className:"w-[50px] h-[20px] rounded-full"}),e.jsx(r,{className:"w-[10px] h-[20px] rounded-full"})]})]}),e.jsxs("div",{className:" flex flex-col gap-1",children:[e.jsxs("div",{className:" flex flex-row justify-between items-end",children:[e.jsxs("div",{className:" flex flex-col gap-1",children:[e.jsx(r,{className:"w-[30px] h-[10px] rounded-full"}),e.jsx(r,{className:"w-[100px] h-[20px] rounded-full"})]}),e.jsx(r,{className:"w-[75px] h-[20px] rounded-full"})]}),e.jsx(r,{className:"w-full h-[10px] rounded-full"}),e.jsxs("div",{className:" flex flex-row justify-between items-end",children:[e.jsx(r,{className:"w-[100px] h-[10px] rounded-full"}),e.jsx(r,{className:"w-[100px] h-[10px] rounded-full"})]})]})]})},s)}function ee({budget:s,deleteAction:x=!0,editAction:v=!0}){let f=(Math.random()+1).toString(36).substring(7);const[c,h]=n.useState(!1);return e.jsx("section",{onClick:i=>{h(!0)},children:e.jsxs("div",{className:" flex flex-col gap-2 border rounded p-4 cursor-pointer",children:[e.jsxs("div",{className:" flex flex-row gap-2 justify-between",children:[e.jsx("span",{className:" font-medium w-full md:w-auto whitespace-nowrap overflow-hidden text-ellipsis",children:s&&"name"in s?s==null?void 0:s.name:"-"}),e.jsxs("div",{className:" flex flex-row flex-1 md:flex-none justify-between gap-2 items-center",children:[e.jsx("span",{className:" font-normal text-nowrap",children:y(s&&"amount"in s?s.amount:0)}),e.jsx("div",{children:e.jsxs(q,{open:c,onOpenChange:h,children:[e.jsx(_,{asChild:!0,children:e.jsx(w,{variant:"link",className:" p-0 h-auto leading-none dark:!text-white !text-black","data-type":"dropdown-trigger",children:e.jsx("i",{className:"fa-solid fa-ellipsis-vertical"})})}),e.jsxs(K,{sideOffset:5,alignOffset:0,side:"left",align:"start",children:[(()=>s&&"uuid"in s?e.jsx(e.Fragment,{children:e.jsx(A,{href:route("sys.budget.show",{uuid:s.uuid}),children:e.jsx(S,{className:" cursor-pointer",children:e.jsx("span",{className:" text-blue-500",children:"Detail"})})})}):e.jsx(e.Fragment,{}))(),(()=>document.getElementById("budget-dialogSection")&&v?e.jsx(S,{className:" cursor-pointer",onClick:p=>{let a=p.target;if(a){let j=a.innerHTML;a.innerHTML='<span class=" flex items-center gap-1"><i class="fa-solid fa-spinner fa-spin-pulse"></i>Loading</span>';const d=()=>{j&&(a.innerHTML=j),document.removeEventListener("dialog.budget.shown",d)};document.addEventListener("dialog.budget.shown",d)}document.dispatchEvent(new CustomEvent("budget.edit-action",{bubbles:!0,detail:{uuid:s&&"uuid"in s?s==null?void 0:s.uuid:""}}))},children:e.jsx("span",{className:" text-yellow-500",children:"Edit"})}):e.jsx(e.Fragment,{}))(),(()=>{let i=document.getElementById("budget-deleteDialogSection");return x&&i?e.jsx(S,{className:" cursor-pointer",onClick:()=>{document.dispatchEvent(new CustomEvent("budget.delete-action",{bubbles:!0,detail:{uuid:s&&"uuid"in s?s==null?void 0:s.uuid:null,action:"delete"}}))},children:e.jsx("span",{className:" text-red-500",children:"Delete"})}):e.jsx(e.Fragment,{})})()]})]})})]})]}),e.jsxs("div",{className:" flex flex-col gap-1",children:[e.jsxs("div",{className:" flex flex-row justify-between items-end",children:[e.jsxs("div",{className:" flex flex-col",children:[e.jsx("small",{className:" leading-none",children:"Remaining"}),e.jsx("span",{className:" leading-tight",children:y(s&&"remaining"in s?s.remaining:0)})]}),e.jsxs("span",{children:[y(s&&"remaining"in s&&"amount"in s?s.remaining/s.amount*100:100,!1,""),"%"]})]}),e.jsx("div",{className:" h-2 w-full rounded-full relative bg-gray-100 dark:bg-gray-700 overflow-hidden",children:e.jsx("div",{className:" h-full w-full absolute left-0 top-0 bg-primary",style:{width:`${s&&"remaining"in s&&"amount"in s?s.remaining/s.amount*100:100}%`}})}),(()=>s&&"start"in s&&"end"in s?e.jsx(e.Fragment,{children:e.jsxs("div",{className:" flex flex-row justify-between gap-4",children:[e.jsx("small",{children:T(s.start).format("MMM Do, YYYY / HH:mm")}),e.jsx("small",{children:T(s.end).format("MMM Do, YYYY / HH:mm")})]})}):e.jsx(e.Fragment,{}))()]})]})},f)}function je({auth:s}){const x=O(),[v,f]=n.useState(!0);n.useEffect(()=>{u()},[]);const[c,h]=n.useState("");n.useEffect(()=>{if(!x){const t=setTimeout(()=>{k(d),u()},500);return()=>{clearTimeout(t)}}},[c]);const[i,p]=n.useState(null),[a,j]=n.useState();let d=5;const[b,D]=n.useState(0),[E,M]=n.useState(0),[N,k]=n.useState(d),[I,L]=n.useState(!1),u=async()=>{f(!0),i instanceof AbortController&&i.abort();const t=new AbortController;p(t);const g=[],o={limit:N,keyword:c};for(const l in o)g.push(encodeURIComponent(l)+"="+encodeURIComponent(o[l]));try{let m=(await C.get(`${route("api.budget.v1.list")}?${g.join("&")}`,{cancelToken:new C.CancelToken(function(Y){t.abort=Y})})).data;j(m.result.data),L(m.result.has_more),D(m.result.data.length),"total"in m.result&&M(m.result.total),f(!1),p(null)}catch(l){C.isCancel(l)?console.log("Request was canceled",l):console.error("Error:",l)}};n.useEffect(()=>{x||u()},[N]);const[B,F]=n.useState(5);let R=()=>e.jsx(Z,{});n.useEffect(()=>{a&&F(a.length>0?a.length:3)},[a]);let H=t=>e.jsx(ee,{budget:t});return n.useEffect(()=>{const t=()=>{setTimeout(()=>{u()},100)};return document.addEventListener("dialog.budget.hidden",t),document.addEventListener("budget.deleted-action",t),()=>{document.removeEventListener("dialog.budget.hidden",t),document.removeEventListener("budget.deleted-action",t)}}),e.jsx(e.Fragment,{children:e.jsxs(U,{user:s.user,header:e.jsx("h2",{className:"font-semibold text-xl text-gray-800 leading-tight",children:"Budget List"}),fabAction:["budget"],children:[e.jsx($,{title:"Budget List"}),e.jsxs(z,{className:" w-full",children:[e.jsx(G,{children:e.jsxs("div",{className:" flex flex-row justify-between items-start",children:[e.jsxs("div",{children:[e.jsx(J,{children:e.jsx("div",{children:"Budget: List"})}),e.jsx(Q,{children:"Manage your budget"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(w,{variant:"outline",className:" w-10 aspect-square",onClick:()=>{i instanceof AbortController&&i.abort(),u()},children:e.jsx("i",{className:"fa-solid fa-rotate-right"})}),e.jsx(w,{variant:"outline",className:" w-10 aspect-square",onClick:()=>{document.dispatchEvent(new CustomEvent("budget.edit-action",{bubbles:!0}))},children:e.jsx("i",{className:"fa-solid fa-plus"})})]})]})}),e.jsx(V,{children:e.jsxs("div",{className:"flex flex-col gap-6",children:[e.jsx("div",{className:" flex flex-row gap-2",children:e.jsx(X,{placeholder:"Search by Budget name",value:c,onChange:t=>{h(t.target.value)}})}),e.jsx("div",{className:" flex flex-col gap-4",children:(()=>{let t=[],g=e.jsx(P,{});if(v)for(let o=0;o<B;o++)t.push(e.jsx("div",{children:R()},`skeleton-${o}`));else a&&a.length>0&&a.map((o,l)=>{t.push(e.jsx("div",{children:H(o)},`budget_item-${l}`))});return t.length>0?t:g})()})]})}),e.jsxs(W,{className:"flex justify-between items-center",children:[e.jsx(w,{variant:"outline",className:"dark:border-white",disabled:!I,onClick:()=>{L(!1),k(N+d)},children:"Load more"}),(()=>b>0&&E>0?e.jsx(e.Fragment,{children:e.jsxs("span",{className:"text-sm",children:["Showing ",b," of ",E," entries"]})}):e.jsx(e.Fragment,{}))()]})]})]})})}export{je as default};
