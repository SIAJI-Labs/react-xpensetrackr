import{r as s,e as p,j as e,a as Q}from"./app-8702d29f.js";import{u as V,B as h}from"./button-28f38a7f.js";import{T as X,S as Y}from"./SkeletonList-fe9f38fb.js";import{T as Z}from"./TemplateNoData-e68c8245.js";import{S as ee}from"./SystemLayout-1675bfbc.js";import{C as te,b as re,c as se,d as oe,a as ae,e as le}from"./card-121fbb50.js";import{I as ne}from"./input-ca1e14e0.js";import ie from"./Filter-c1824ba1.js";/* empty css            */import"./function-a414ed73.js";import"./siaji-9629b5aa.js";import"./badge-f6be1592.js";import"./skeleton-cf33ca45.js";import"./ApplicationLogo-72a9fc4a.js";import"./x-8a52df80.js";import"./scroll-area-0af09a9c.js";import"./theme-toggle-7a59986b.js";import"./ApplicationLogoMask-506684f0.js";function ke({auth:N,type:L="complete"}){const k=V(),I=r=>e.jsx(X,{record:r});let W=e.jsx(Y,{});const[d,$]=s.useState(!1),[u,_]=s.useState(""),[x,A]=s.useState(L),[g,q]=s.useState([]),[j,D]=s.useState([]),[C,P]=s.useState([]),[S,O]=s.useState([]),F=()=>{if(!k){const r=setTimeout(()=>{v(m),i()},500);return()=>{clearTimeout(r)}}};s.useEffect(()=>{F()},[u]),s.useEffect(()=>{d||F()},[d]);let m=5;const[R,B]=s.useState(0),[T,K]=s.useState(0),[f,v]=s.useState(m),[U,y]=s.useState(!1);s.useEffect(()=>{i()},[f]);const[H,E]=s.useState(!0),[z,G]=s.useState(5),[l,J]=s.useState([]),[n,b]=s.useState(null);s.useEffect(()=>{G(l.length>0?l.length:3)},[l]);const i=async()=>{n instanceof AbortController&&n.abort();const r=new AbortController;b(r),E(!0);const a=[],c={limit:f,filter_status:x,keyword:u};for(const t in c)a.push(encodeURIComponent(t)+"="+encodeURIComponent(c[t]));g.filter(t=>"uuid"in t).forEach((t,o)=>{a.push(`filter_from_wallet[${o}] = ${t.uuid}`)}),j.filter(t=>"uuid"in t).forEach((t,o)=>{a.push(`filter_to_wallet[${o}] = ${t.uuid}`)}),C.filter(t=>"uuid"in t).forEach((t,o)=>{a.push(`filter_category[${o}] = ${t.uuid}`)}),S.filter(t=>"uuid"in t).forEach((t,o)=>{a.push(`filter_tags[${o}] = ${t.uuid}`)});try{let o=(await p.get(`${route("api.record.v1.list")}?${a.join("&")}`,{cancelToken:new p.CancelToken(function(M){r.abort=M})})).data;J(o.result.data),y(o.result.has_more),B(o.result.data.length),"total"in o.result&&K(o.result.total),E(!1),b(null)}catch(t){p.isCancel(t)?console.log("Request was canceled",t):console.error("Error:",t)}};return s.useEffect(()=>{const r=()=>{setTimeout(()=>{i()},100)};return document.addEventListener("dialog.record.hidden",r),document.addEventListener("record.deleted-action",r),()=>{document.removeEventListener("dialog.record.hidden",r),document.removeEventListener("record.deleted-action",r)}}),e.jsx(e.Fragment,{children:e.jsxs(ee,{user:N.user,header:e.jsx("h2",{className:"font-semibold text-xl text-gray-800 leading-tight",children:"Record List"}),children:[e.jsx(Q,{title:"Record List"}),e.jsx("div",{className:"flex flex-col gap-6",children:e.jsxs(te,{className:"",children:[e.jsx(re,{children:e.jsxs("div",{className:" flex flex-row justify-between items-start",children:[e.jsxs("div",{children:[e.jsx(se,{children:e.jsx("div",{children:"Record: List"})}),e.jsx(oe,{children:"See your latest transaction"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(h,{variant:"outline",className:" w-10 aspect-square",onClick:()=>{n instanceof AbortController&&n.abort(),i()},children:e.jsx("i",{className:"fa-solid fa-rotate-right"})}),e.jsx(h,{variant:"outline",className:" w-10 aspect-square",onClick:()=>{document.dispatchEvent(new CustomEvent("record.edit-action",{bubbles:!0}))},children:e.jsx("i",{className:"fa-solid fa-plus"})})]})]})}),e.jsxs(ae,{className:" flex flex-col gap-6",children:[e.jsxs("div",{className:" flex flex-row gap-2",children:[e.jsx(ne,{placeholder:"Search by record notes",value:u,onChange:r=>{_(r.target.value)}}),e.jsx(ie,{openState:d,setOpenState:$,filterStatus:x,setFilterStatus:A,filterFromWallet:g,setFilterFromWallet:q,filterToWallet:j,setFilterToWallet:D,filterCategory:C,setFilterCategory:P,filterTags:S,setFilterTags:O})]}),e.jsx("div",{className:" flex flex-col gap-4",children:(()=>{if(H){let r=[];for(let a=0;a<z;a++)r.push(e.jsx("div",{children:W},`skeleton-${a}`));return r}else{let r=[],a=e.jsx(Z,{});return l.length>0&&l.map((c,w)=>{r.push(e.jsx("div",{children:I(c)},`record_item-${w}`))}),r.length>0?r:a}})()})]}),e.jsxs(le,{className:"flex justify-between items-center",children:[e.jsx(h,{variant:"outline",className:"",disabled:!U,onClick:()=>{y(!1),v(f+m)},children:"Load more"}),(()=>R>0&&T>0?e.jsx(e.Fragment,{children:e.jsxs("span",{className:"text-sm",children:["Showing ",R," of ",T," entries"]})}):e.jsx(e.Fragment,{}))()]})]})})]})})}export{ke as default};
