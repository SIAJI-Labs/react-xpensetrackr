import{j as e,r as s,e as g,a as D,d as _}from"./app-0ff37107.js";import{u as q,B as i}from"./button-a5a722b8.js";import{T as B}from"./TemplateList-7e52dc56.js";import{T as K}from"./TemplateNoData-1088f1d4.js";import{S as P}from"./SystemLayout-5bf3bc13.js";import{C as U,b as H,c as M,a as z,d as G}from"./card-1bd90e8f.js";import{S}from"./skeleton-a108b8f6.js";import{I as J}from"./input-d03631fe.js";import"./function-a0a83c3b.js";import"./ApplicationLogo-9a435e93.js";import"./ApplicationLogoMask-d548810d.js";import"./textarea-2184d8d3.js";function O(){let u=(Math.random()+1).toString(36).substring(7);return e.jsx("section",{children:e.jsx("div",{className:" flex flex-col gap-2 border rounded p-4",children:e.jsxs("div",{className:" flex flex-row justify-between",children:[e.jsx(S,{className:"w-[100px] h-[20px] rounded-full"}),e.jsx("div",{className:" flex flex-row gap-2",children:e.jsx(S,{className:"w-[10px] h-[20px] rounded-full"})})]})})},u)}function le({auth:u}){const h=q(),[w,j]=s.useState(!0);s.useEffect(()=>{n()},[]);const[m,N]=s.useState("");s.useEffect(()=>{if(!h){const t=setTimeout(()=>{v(f),n()},500);return()=>{clearTimeout(t)}}},[m]);const[c,p]=s.useState(null);s.useState(!0);const[o,E]=s.useState();let f=5;const[y,k]=s.useState(0),[C,L]=s.useState(0),[x,v]=s.useState(f),[T,b]=s.useState(!1),n=async()=>{j(!0),c instanceof AbortController&&c.abort();const t=new AbortController;p(t);const a=[],d={limit:x,keyword:m};for(const r in d)a.push(encodeURIComponent(r)+"="+encodeURIComponent(d[r]));try{let l=(await g.get(`${route("api.category.v1.list")}?${a.join("&")}`,{cancelToken:new g.CancelToken(function($){t.abort=$})})).data;E(l.result.data),b(l.result.has_more),k(l.result.data.length),"total"in l.result&&L(l.result.total),j(!1),p(null)}catch(r){g.isCancel(r)?console.log("Request was canceled",r):console.error("Error:",r)}};s.useEffect(()=>{h||n()},[x]);const[I,R]=s.useState(5);let F=()=>e.jsx(O,{});s.useEffect(()=>{o&&R(o.length>0?o.length:3)},[o]);let A=t=>e.jsx(B,{category:t});return s.useEffect(()=>{const t=()=>{setTimeout(()=>{n()},100)};return document.addEventListener("dialog.category.hidden",t),document.addEventListener("category.deleted-action",t),()=>{document.removeEventListener("dialog.category.hidden",t),document.removeEventListener("category.deleted-action",t)}}),e.jsx(e.Fragment,{children:e.jsxs(P,{user:u.user,header:e.jsx("h2",{className:"font-semibold text-xl text-gray-800 leading-tight",children:"Category List"}),fabAction:["category"],children:[e.jsx(D,{title:"Category List"}),e.jsxs(U,{className:" w-full",children:[e.jsx(H,{children:e.jsxs("div",{className:" flex flex-row justify-between items-start",children:[e.jsx("div",{children:e.jsx(M,{children:e.jsx("div",{children:"Category: List"})})}),e.jsxs("div",{className:"flex items-center gap-2",children:[(()=>e.jsx(i,{variant:"outline",onClick:()=>{c instanceof AbortController&&c.abort(),n()},children:e.jsx("i",{className:"fa-solid fa-rotate-right"})}))(),e.jsx(i,{variant:"outline",onClick:()=>{document.dispatchEvent(new CustomEvent("category.edit-action",{bubbles:!0}))},children:e.jsx("i",{className:"fa-solid fa-plus"})})]})]})}),e.jsx(z,{children:e.jsxs("div",{className:"flex flex-col gap-6",children:[e.jsxs("div",{className:" flex flex-row gap-4",children:[e.jsx(J,{placeholder:"Search by Category name",value:m,onChange:t=>{N(t.target.value)}}),e.jsx(i,{disabled:!0,children:e.jsx("i",{className:"fa-solid fa-filter"})}),e.jsx(_,{href:route("sys.category.re-order.index"),children:e.jsx(i,{variant:"outline",children:e.jsx("i",{className:"fa-solid fa-sort"})})})]}),e.jsx("div",{className:" flex flex-col gap-4",children:(()=>{if(w){let t=[];for(let a=0;a<I;a++)t.push(e.jsx("div",{children:F()},`skeleton-${a}`));return t}else{let t=[],a=e.jsx(K,{});return o&&o.length>0&&o.map((d,r)=>{t.push(e.jsx("div",{children:A(d)},`category_item-${r}`))}),t.length>0?t:a}})()})]})}),e.jsxs(G,{className:"flex justify-between items-center",children:[e.jsx(i,{variant:"outline",className:"dark:border-white",disabled:!T,onClick:()=>{b(!1),v(x+f)},children:"Load more"}),(()=>y>0&&C>0?e.jsx(e.Fragment,{children:e.jsxs("span",{className:"text-sm",children:["Showing ",y," of ",C," entries"]})}):e.jsx(e.Fragment,{}))()]})]})]})})}export{le as default};
