import{r as s,j as e,a as oe,y as re,e as O}from"./app-b8aeab2c.js";import{$ as ie,a as l,C as q}from"./function-b010ed60.js";import{T as ce}from"./TemplateBackButton-005f68bc.js";import{$ as le,S as de}from"./SystemLayout-1161c764.js";import{P as H,a as U,b as V,C as G,c as L,S as W,d as z,e as X,f as J}from"./scroll-area-c0be1b87.js";import{C as me,a as fe}from"./card-93e54316.js";import{d as pe,e as ue,f as he,$ as Z,_ as R,g as xe,c as K,u as be,B as P}from"./button-ac603a4e.js";import{S as ge}from"./separator-cdaf02a6.js";import{C as Q}from"./theme-toggle-4b5a3be1.js";/* empty css            */import"./siaji-72a91678.js";import"./ApplicationLogo-422d5d0c.js";import"./x-91316834.js";import"./input-76683f84.js";import"./TemplateNoData-f5b55890.js";import"./ApplicationLogoMask-34b91daf.js";const ee="Switch",[je,Ve]=pe(ee),[we,ve]=je(ee),Ne=s.forwardRef((n,p)=>{const{__scopeSwitch:o,name:u,checked:h,defaultChecked:w,required:d,disabled:r,value:x="on",onCheckedChange:m,...C}=n,[a,v]=s.useState(null),b=ue(p,j=>v(j)),$=s.useRef(!1),f=a?!!a.closest("form"):!0,[g=!1,D]=he({prop:h,defaultProp:w,onChange:m});return s.createElement(we,{scope:o,checked:g,disabled:r},s.createElement(Z.button,R({type:"button",role:"switch","aria-checked":g,"aria-required":d,"data-state":te(g),"data-disabled":r?"":void 0,disabled:r,value:x},C,{ref:b,onClick:xe(n.onClick,j=>{D(y=>!y),f&&($.current=j.isPropagationStopped(),$.current||j.stopPropagation())})})),f&&s.createElement(Ce,{control:a,bubbles:!$.current,name:u,value:x,checked:g,required:d,disabled:r,style:{transform:"translateX(-100%)"}}))}),$e="SwitchThumb",Se=s.forwardRef((n,p)=>{const{__scopeSwitch:o,...u}=n,h=ve($e,o);return s.createElement(Z.span,R({"data-state":te(h.checked),"data-disabled":h.disabled?"":void 0},u,{ref:p}))}),Ce=n=>{const{control:p,checked:o,bubbles:u=!0,...h}=n,w=s.useRef(null),d=le(o),r=ie(p);return s.useEffect(()=>{const x=w.current,m=window.HTMLInputElement.prototype,a=Object.getOwnPropertyDescriptor(m,"checked").set;if(d!==o&&a){const v=new Event("click",{bubbles:u});a.call(x,o),x.dispatchEvent(v)}},[d,o,u]),s.createElement("input",R({type:"checkbox","aria-hidden":!0,defaultChecked:o},h,{tabIndex:-1,ref:w,style:{...n.style,...r,position:"absolute",pointerEvents:"none",opacity:0,margin:0}}))};function te(n){return n?"checked":"unchecked"}const se=Ne,ye=Se,k=s.forwardRef(({className:n,...p},o)=>e.jsx(se,{className:K("peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input",n),...p,ref:o,children:e.jsx(ye,{className:K("pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0")})}));k.displayName=se.displayName;function Ge({auth:n,notificationState:p,notificationPlannedPaymentState:o,notificationPlannedPaymentTime:u,notificationPendingRecordState:h,notificationPendingRecordTime:w}){const d=be(),[r,x]=s.useState(p),[m,C]=s.useState(o),[a,v]=s.useState(u),[b,$]=s.useState(h),[f,g]=s.useState(w),[D,j]=s.useState({}),[y,E]=s.useState(null),S=t=>{console.log(t),y instanceof AbortController&&y.abort(),j({});const c=new AbortController;E(c),t.append("_method","PUT"),t.append("action","notification-preference");let i=route("api.profile.v1.update",n.user.uuid);O.post(i,t,{cancelToken:new O.CancelToken(function(Y){c.abort=Y})}).then(N=>{N.status}).catch(N=>{var M;let F=(M=N.response)==null?void 0:M.data;F.errors&&j(F.errors),setTimeout(()=>{const A=document.querySelectorAll("#preference-notification .form--group.is--invalid");A.length>0&&Array.from(A).reduce((B,I)=>B.offsetTop>I.offsetTop?I:B).scrollIntoView({behavior:"smooth"})},100)}).finally(()=>{E(null)})};s.useEffect(()=>{if(!d){let t=new FormData;t.append("state","notification"),t.append("state_value",r.toString()),S(t)}},[r]),s.useEffect(()=>{if(m||v(void 0),!d){let t=new FormData;t.append("state","notification_plannedPayment"),t.append("state_value",m.toString()),S(t)}},[m]),s.useEffect(()=>{if(!d&&m){let t=new FormData;t.append("state","time_plannedPayment"),t.append("state_value",a&&a!==null?a.toString():""),S(t)}},[a]),s.useEffect(()=>{if(m||g(void 0),!d){let t=new FormData;t.append("state","notification_pendingRecord"),t.append("state_value",b.toString()),S(t)}},[b]),s.useEffect(()=>{if(!d&&b){let t=new FormData;t.append("state","time_pendingRecord"),t.append("state_value",f&&f!==null?f.toString():""),S(t)}},[f]);const[ae,_]=s.useState(!1),[ne,T]=s.useState(!1);return e.jsxs(de,{user:n.user,header:e.jsx("h2",{className:"font-semibold text-xl text-gray-800 leading-tight",children:"Notification"}),children:[e.jsx(oe,{title:"Notification"}),e.jsx("div",{className:"flex flex-col gap-6",children:e.jsx(ce,{className:"px-0"})}),e.jsx(me,{id:"preference-notification",children:e.jsxs(fe,{className:" flex flex-col gap-6 p-6",children:[e.jsxs("div",{className:" flex flex-col gap-4 rounded-lg border p-4",children:[e.jsxs("div",{className:"flex flex-row items-center justify-between",children:[e.jsxs("div",{className:" flex flex-col gap-1 space-y-0.5 leading-none",children:[e.jsx("label",{className:"text-base font-medium leading-tight",children:"Push notification"}),e.jsx("span",{className:" text-sm leading-none",children:"Receive push notification"})]}),e.jsx(k,{checked:r,onCheckedChange:t=>{x(t)}})]}),(()=>{if("Notification"in window&&r){if(["denied","default"].includes(String(Notification.permission))||Notification.permission===void 0)return e.jsx(e.Fragment,{children:e.jsxs("div",{className:" w-full flex flex-row gap-1 p-4 rounded-lg border-2 border-dashed border-red-300",children:[e.jsxs("span",{children:["We're not granted push notification permission ",Notification.permission==="denied"?e.jsx("strong",{className:"underline text-sm",children:" (Permission Denied)"}):"","."]}),(()=>Notification.permission==="default"?e.jsx(P,{variant:"link",className:" h-auto p-0 text-base",onClick:()=>{Notification.requestPermission().then(t=>{re.reload()})},children:"Give permission"}):e.jsx(e.Fragment,{}))()]})})}else if(!("Notification"in window))return e.jsx(e.Fragment,{children:e.jsx("div",{className:" w-full p-4 rounded-lg border-2 border-dashed border-yellow-500",children:e.jsx("span",{children:"Push notification is not supported in this device"})})});return e.jsx(e.Fragment,{})})()]}),e.jsx(ge,{}),e.jsxs("fieldset",{className:` ${r?"":" opacity-50"} flex flex-col gap-4`,disabled:!r,children:[e.jsxs("div",{className:" flex flex-col gap-4 border p-4 rounded-lg",children:[e.jsxs("div",{className:"flex flex-col gap-2 ",children:[e.jsxs("div",{className:" flex flex-row items-center justify-between",children:[e.jsx("label",{className:"text-base font-medium leading-tight",children:"Planned Payment"}),e.jsx(k,{checked:m,onCheckedChange:t=>{C(t)}})]}),e.jsx("span",{className:" text-sm leading-none",children:"Remind me about my upcoming, today, and overdue scheduled payment"})]}),e.jsx("fieldset",{className:" border-t pt-2",disabled:!m,children:e.jsxs("div",{className:" flex flex-row justify-between items-center",children:[e.jsx("label",{className:" w-full",children:"Receive notification at"}),e.jsx("div",{className:"w-full form--group !mb-0",id:"record_dialog-hours",children:e.jsxs(H,{open:ae,onOpenChange:_,children:[e.jsx(U,{asChild:!0,children:e.jsxs(P,{variant:"outline",role:"combobox",className:"w-full justify-between dark:text-white",children:[e.jsx("span",{className:" whitespace-nowrap overflow-hidden w-full text-ellipsis text-left font-light",children:a&&a!==null?a:"Select Timestamp"}),e.jsx(Q,{className:"ml-2 h-4 w-4 shrink-0 opacity-50"})]})}),e.jsx(V,{className:" w-[175px] lg:w-[400px] p-0",align:"end",children:e.jsxs(G,{children:[e.jsx(L,{placeholder:"Search Timestamp",className:" border-none focus:ring-0"}),e.jsx(W,{className:"p-0",children:e.jsxs("div",{className:"max-h-[10rem]",children:[e.jsx(z,{children:"No timestamp found"}),e.jsx(X,{children:(()=>{let t=[],c=l(`${l().format("YYYY-MM-DD")} 00:00:00`);do{let i=l(c).format("HH:mm").toString();t.push(e.jsxs(J,{value:i,onSelect:N=>{v(i),_(!1)},children:[e.jsx(q,{className:`mr-2 h-4 w-4 ${a===i?"opacity-100":"opacity-0"} `}),i]},`planned_timestamp-${i}`)),c=l(c).add(15,"minutes")}while(l(c).format("YYYY-MM-DD").toString()===l().format("YYYY-MM-DD").toString());return t.length>0?t:e.jsx(e.Fragment,{})})()})]})})]})})]})})]})})]}),e.jsxs("div",{className:" flex flex-col gap-4 border p-4 rounded-lg",children:[e.jsxs("div",{className:"flex flex-col gap-2 ",children:[e.jsxs("div",{className:" flex flex-row items-center justify-between",children:[e.jsx("label",{className:"text-base font-medium leading-tight",children:"Pending Record"}),e.jsx(k,{checked:b,onCheckedChange:t=>{$(t)}})]}),e.jsx("span",{className:" text-sm leading-none",children:"Remind me about my pending record via Push Notification"})]}),e.jsx("fieldset",{className:" border-t pt-2",disabled:!b,children:e.jsxs("div",{className:" flex flex-row justify-between items-center",children:[e.jsx("label",{className:" w-full",children:"Receive notification at"}),e.jsx("div",{className:"w-full form--group !mb-0",id:"record_dialog-hours",children:e.jsxs(H,{open:ne,onOpenChange:T,children:[e.jsx(U,{asChild:!0,children:e.jsxs(P,{variant:"outline",role:"combobox",className:"w-full justify-between dark:text-white",children:[e.jsx("span",{className:" whitespace-nowrap overflow-hidden w-full text-ellipsis text-left font-light",children:f&&f!==null?f:"Select Timestamp"}),e.jsx(Q,{className:"ml-2 h-4 w-4 shrink-0 opacity-50"})]})}),e.jsx(V,{className:" w-[175px] lg:w-[400px] p-0",align:"end",children:e.jsxs(G,{children:[e.jsx(L,{placeholder:"Search Timestamp",className:" border-none focus:ring-0"}),e.jsx(W,{className:"p-0",children:e.jsxs("div",{className:"max-h-[10rem]",children:[e.jsx(z,{children:"No timestamp found"}),e.jsx(X,{children:(()=>{let t=[],c=l(`${l().format("YYYY-MM-DD")} 00:00:00`);do{let i=l(c).format("HH:mm").toString();t.push(e.jsxs(J,{value:i,onSelect:N=>{g(i),T(!1)},children:[e.jsx(q,{className:`mr-2 h-4 w-4 ${f===i?"opacity-100":"opacity-0"} `}),i]},`pendingRecord_timestamp-${i}`)),c=l(c).add(15,"minutes")}while(l(c).format("YYYY-MM-DD").toString()===l().format("YYYY-MM-DD").toString());return t.length>0?t:e.jsx(e.Fragment,{})})()})]})})]})})]})})]})})]})]})]})})]})}export{Ge as default};
