import{j as e,r as n,d as A,e as C,a as $}from"./app-49e19f09.js";import{B as w,u as O}from"./button-8f2a595a.js";import{S as i}from"./skeleton-3b1a4842.js";import{f as y,h as M}from"./index-961138f1.js";import{D as q,a as _,b as K,c as S,T as P}from"./TemplateNoData-b0444318.js";import{S as U}from"./SystemLayout-a53fff85.js";import{C as z,b as G,c as J,d as Q,a as V,e as W}from"./card-2c105230.js";import{I as X}from"./input-d9c06e18.js";/* empty css            */import"./index-61f18b0c.js";/* empty css              */import"./index-84c40666.js";import"./dialog-dd6b0ada.js";import"./drawer-134f179f.js";import"./theme-toggle-66897dc1.js";import"./ErrorMessage-9da431ff.js";import"./scroll-area-8438057d.js";import"./ApplicationLogoMask-c668ea73.js";import"./ApplicationLogo-c5ad270c.js";function Z(){let t=(Math.random()+1).toString(36).substring(7);return e.jsx("section",{children:e.jsxs("div",{className:" flex flex-col gap-2 border rounded p-4",children:[e.jsxs("div",{className:" flex flex-row justify-between",children:[e.jsx(i,{className:"w-[100px] h-[20px] rounded-full"}),e.jsxs("div",{className:" flex flex-row gap-2",children:[e.jsx(i,{className:"w-[50px] h-[20px] rounded-full"}),e.jsx(i,{className:"w-[10px] h-[20px] rounded-full"})]})]}),e.jsxs("div",{className:" flex flex-col gap-1",children:[e.jsxs("div",{className:" flex flex-row justify-between items-end",children:[e.jsxs("div",{className:" flex flex-col gap-1",children:[e.jsx(i,{className:"w-[30px] h-[10px] rounded-full"}),e.jsx(i,{className:"w-[100px] h-[20px] rounded-full"})]}),e.jsx(i,{className:"w-[75px] h-[20px] rounded-full"})]}),e.jsx(i,{className:"w-full h-[10px] rounded-full"}),e.jsxs("div",{className:" flex flex-row justify-between items-end",children:[e.jsx(i,{className:"w-[100px] h-[10px] rounded-full"}),e.jsx(i,{className:"w-[100px] h-[10px] rounded-full"})]})]})]})},t)}function ee({budget:t,deleteAction:f=!0,editAction:v=!0}){let h=(Math.random()+1).toString(36).substring(7);const[c,m]=n.useState(!1);return n.useEffect(()=>{const l=()=>{setTimeout(()=>{m(!1)},100)};return document.addEventListener("dialog.budget.shown",l),()=>{document.removeEventListener("dialog.budget.shown",l)}}),e.jsx("section",{onClick:l=>{m(!0)},children:e.jsxs("div",{className:" flex flex-col gap-2 border rounded p-4 cursor-pointer",children:[e.jsxs("div",{className:" flex flex-row gap-2 justify-between",children:[e.jsx("span",{className:" font-medium w-full md:w-auto whitespace-nowrap overflow-hidden text-ellipsis",children:t&&"name"in t?t==null?void 0:t.name:"-"}),e.jsxs("div",{className:" flex flex-row flex-1 md:flex-none justify-between gap-2 items-center",children:[e.jsx("span",{className:" font-normal text-nowrap",children:y(t&&"amount"in t?t.amount:0)}),e.jsx("div",{children:e.jsxs(q,{open:c,onOpenChange:m,children:[e.jsx(_,{asChild:!0,children:e.jsx(w,{variant:"link",className:" p-0 h-auto leading-none dark:!text-white !text-black","data-type":"dropdown-trigger",children:e.jsx("i",{className:"fa-solid fa-ellipsis-vertical"})})}),e.jsxs(K,{sideOffset:5,alignOffset:0,side:"left",align:"start",children:[(()=>t&&"uuid"in t?e.jsx(e.Fragment,{children:e.jsx(A,{href:route("sys.budget.show",{uuid:t.uuid}),children:e.jsx(S,{className:" cursor-pointer",children:e.jsx("span",{className:" text-blue-500",children:"Detail"})})})}):e.jsx(e.Fragment,{}))(),(()=>document.getElementById("budget-dialogSection")&&v?e.jsx(S,{className:" cursor-pointer",onClick:p=>{let a=p.target;if(a){let j=a.innerHTML;a.innerHTML='<span class=" flex items-center gap-1"><i class="fa-solid fa-spinner fa-spin-pulse"></i>Loading</span>';const d=()=>{j&&(a.innerHTML=j),document.removeEventListener("dialog.budget.shown",d)};document.addEventListener("dialog.budget.shown",d)}document.dispatchEvent(new CustomEvent("budget.edit-action",{bubbles:!0,detail:{uuid:t&&"uuid"in t?t==null?void 0:t.uuid:""}}))},children:e.jsx("span",{className:" text-yellow-500",children:"Edit"})}):e.jsx(e.Fragment,{}))(),(()=>{let l=document.getElementById("budget-deleteDialogSection");return f&&l?e.jsx(S,{className:" cursor-pointer",onClick:()=>{document.dispatchEvent(new CustomEvent("budget.delete-action",{bubbles:!0,detail:{uuid:t&&"uuid"in t?t==null?void 0:t.uuid:null,action:"delete"}}))},children:e.jsx("span",{className:" text-red-500",children:"Delete"})}):e.jsx(e.Fragment,{})})()]})]})})]})]}),e.jsxs("div",{className:" flex flex-col gap-1",children:[e.jsxs("div",{className:" flex flex-row justify-between items-end",children:[e.jsxs("div",{className:" flex flex-col",children:[e.jsx("small",{className:" leading-none",children:"Remaining"}),e.jsx("span",{className:" leading-tight",children:y(t&&"remaining"in t?t.remaining:0)})]}),e.jsxs("span",{children:[y(t&&"remaining"in t&&"amount"in t?Math.max(t.remaining,1)/Math.max(t.amount,1)*100:100,!1,""),"%"]})]}),e.jsx("div",{className:" h-2 w-full rounded-full relative bg-gray-100 dark:bg-gray-700 overflow-hidden",children:e.jsx("div",{className:" h-full w-full absolute left-0 top-0 bg-primary",style:{width:`${t&&"remaining"in t&&"amount"in t?Math.max(t.remaining,1)/Math.max(t.amount,1)*100:100}%`}})}),(()=>t&&"start"in t&&"end"in t?e.jsx(e.Fragment,{children:e.jsxs("div",{className:" flex flex-row justify-between gap-4",children:[e.jsx("small",{children:M(t.start).format("MMM Do, YYYY / HH:mm")}),e.jsx("small",{children:M(t.end).format("MMM Do, YYYY / HH:mm")})]})}):e.jsx(e.Fragment,{}))()]})]})},h)}function Ne({auth:t}){const f=O(),[v,h]=n.useState(!0);n.useEffect(()=>{u()},[]);const[c,m]=n.useState("");n.useEffect(()=>{if(!f){const s=setTimeout(()=>{k(d),u()},500);return()=>{clearTimeout(s)}}},[c]);const[l,p]=n.useState(null),[a,j]=n.useState();let d=5;const[E,T]=n.useState(0),[b,D]=n.useState(0),[N,k]=n.useState(d),[I,L]=n.useState(!1),u=async()=>{h(!0),l instanceof AbortController&&l.abort();const s=new AbortController;p(s);const g=[],o={limit:N,keyword:c};for(const r in o)g.push(encodeURIComponent(r)+"="+encodeURIComponent(o[r]));try{let x=(await C.get(`${route("api.budget.v1.list")}?${g.join("&")}`,{cancelToken:new C.CancelToken(function(Y){s.abort=Y})})).data;j(x.result.data),L(x.result.has_more),T(x.result.data.length),"total"in x.result&&D(x.result.total),h(!1),p(null)}catch(r){C.isCancel(r)?console.log("Request was canceled",r):console.error("Error:",r)}};n.useEffect(()=>{f||u()},[N]);const[B,F]=n.useState(5);let R=()=>e.jsx(Z,{});n.useEffect(()=>{a&&F(a.length>0?a.length:3)},[a]);let H=s=>e.jsx(ee,{budget:s});return n.useEffect(()=>{const s=()=>{setTimeout(()=>{u()},100)};return document.addEventListener("dialog.budget.hidden",s),document.addEventListener("budget.deleted-action",s),()=>{document.removeEventListener("dialog.budget.hidden",s),document.removeEventListener("budget.deleted-action",s)}}),e.jsx(e.Fragment,{children:e.jsxs(U,{user:t.user,header:e.jsx("h2",{className:"font-semibold text-xl text-gray-800 leading-tight",children:"Budget List"}),fabAction:["budget"],children:[e.jsx($,{title:"Budget List"}),e.jsxs(z,{className:" w-full",children:[e.jsx(G,{children:e.jsxs("div",{className:" flex flex-row justify-between items-start",children:[e.jsxs("div",{children:[e.jsx(J,{children:e.jsx("div",{children:"Budget: List"})}),e.jsx(Q,{children:"Manage your budget"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(w,{variant:"outline",className:" w-10 aspect-square",onClick:()=>{l instanceof AbortController&&l.abort(),u()},children:e.jsx("i",{className:"fa-solid fa-rotate-right"})}),e.jsx(w,{variant:"outline",className:" w-10 aspect-square",onClick:()=>{document.dispatchEvent(new CustomEvent("budget.edit-action",{bubbles:!0}))},children:e.jsx("i",{className:"fa-solid fa-plus"})})]})]})}),e.jsx(V,{children:e.jsxs("div",{className:"flex flex-col gap-6",children:[e.jsx("div",{className:" flex flex-row gap-2",children:e.jsx(X,{placeholder:"Search by Budget name",value:c,onChange:s=>{m(s.target.value)}})}),e.jsx("div",{className:" flex flex-col gap-4",children:(()=>{let s=[],g=e.jsx(P,{});if(v)for(let o=0;o<B;o++)s.push(e.jsx("div",{children:R()},`skeleton-${o}`));else a&&a.length>0&&a.map((o,r)=>{s.push(e.jsx("div",{children:H(o)},`budget_item-${r}`))});return s.length>0?s:g})()})]})}),e.jsxs(W,{className:"flex justify-between items-center",children:[e.jsx(w,{variant:"outline",className:"dark:border-white",disabled:!I,onClick:()=>{L(!1),k(N+d)},children:"Load more"}),(()=>E>0&&b>0?e.jsx(e.Fragment,{children:e.jsxs("span",{className:"text-sm",children:["Showing ",E," of ",b," entries"]})}):e.jsx(e.Fragment,{}))()]})]})]})})}export{Ne as default};
