import{r as n,e as p,j as e}from"./app-9b797eab.js";import{u as R,B as y}from"./button-e96d6135.js";import{T as A}from"./TemplateList-6191d149.js";import{T as $}from"./TemplateNoData-790ebee6.js";import{I as D}from"./input-5acbf981.js";import{S as _}from"./SkeletonList-d3cd5ea5.js";import"./Combination-6ff7b57c.js";import"./dropdown-menu-9e10cee1.js";import"./badge-687599c6.js";import"./skeleton-a8f7b09a.js";function X({auth:q,activeType:B}){const d=R();n.useEffect(()=>{r()},[]);const[f,h]=n.useState(null),[C,x]=n.useState(!0),[o,w]=n.useState();let c=5;const[g,v]=n.useState(0),[j,T]=n.useState(0),[u,P]=n.useState(c),[b,S]=n.useState(!1),r=async()=>{x(!0),f instanceof AbortController&&f.abort();const t=new AbortController;h(t);const s=[],i={limit:u,keyword:m};for(const a in i)s.push(encodeURIComponent(a)+"="+encodeURIComponent(i[a]));try{let l=(await p.get(`${route("api.planned-payment.v1.list")}?${s.join("&")}`,{cancelToken:new p.CancelToken(function(N){t.abort=N})})).data;w(l.result.data),S(l.result.has_more),v(l.result.data.length),"total"in l.result&&T(l.result.total),x(!1),h(null)}catch(a){p.isCancel(a)?console.log("Request was canceled",a):console.error("Error:",a)}},[E,k]=n.useState(5);let I=()=>e.jsx(_,{}),L=t=>e.jsx(A,{plannedPayment:t});n.useEffect(()=>{o&&k(o.length>0?o.length:3)},[o]);const[m,F]=n.useState("");return n.useEffect(()=>{if(!d){const t=setTimeout(()=>{P(c),r()},500);return()=>{clearTimeout(t)}}},[m]),n.useEffect(()=>{d||r()},[u]),n.useEffect(()=>{if(!d){const t=()=>{setTimeout(()=>{console.log("Dialog Event"),r()},100)};return window.addEventListener("planned-payment.refresh",t),()=>{window.removeEventListener("planned-payment.refresh",t)}}}),e.jsx(e.Fragment,{children:e.jsxs("div",{className:"flex flex-col gap-6",children:[e.jsxs("div",{className:" flex flex-row gap-4",children:[e.jsx(D,{placeholder:"Search by Planned Payment name",value:m,onChange:t=>{F(t.target.value)}}),e.jsx(y,{children:e.jsx("i",{className:"fa-solid fa-filter"})})]}),(()=>{if(C){let t=[];for(let s=0;s<E;s++)t.push(e.jsx("div",{children:I()},`skeleton-${s}`));return t}else{let t=[],s=e.jsx($,{});return o&&o.length>0&&o.map((i,a)=>{t.push(e.jsx("div",{children:L(i)},`planned_item-${a}`))}),t.length>0?t:s}})(),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx(y,{variant:"outline",className:"dark:border-white",disabled:!b,onClick:()=>{S(!1),P(u+c)},children:"Load more"}),(()=>g>0&&j>0?e.jsx(e.Fragment,{children:e.jsxs("span",{className:"text-sm",children:["Showing ",g," of ",j," entries"]})}):e.jsx(e.Fragment,{}))()]})]})})}export{X as default};
