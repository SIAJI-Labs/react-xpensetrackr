import{r as n,e as u,j as t}from"./app-0f7f6890.js";import{u as L,B as j}from"./button-ca44c454.js";import{L as T}from"./ListTemplate-0736a6ad.js";import{N as R}from"./skeleton-9245f950.js";import{I as N}from"./input-72062d81.js";import{L as F}from"./ListSkeleton-a8fd23eb.js";import"./Combination-efa42deb.js";import"./dropdown-menu-7ce55958.js";import"./badge-2468a7a7.js";function M({auth:A,activeType:$}){const i=L();n.useEffect(()=>{l()},[]);const[p,f]=n.useState(null),[y,h]=n.useState(!0),[o,S]=n.useState();let d=5;const[c,x]=n.useState(d),[v,g]=n.useState(!1),l=async()=>{h(!0),p instanceof AbortController&&p.abort();const e=new AbortController;f(e);const s=[],r={limit:c,keyword:m};for(const a in r)s.push(encodeURIComponent(a)+"="+encodeURIComponent(r[a]));try{let P=(await u.get(`${route("api.planned-payment.v1.list")}?${s.join("&")}`,{cancelToken:new u.CancelToken(function(I){e.abort=I})})).data;S(P.result.data),g(P.result.has_more),h(!1),f(null)}catch(a){u.isCancel(a)?console.log("Request was canceled",a):console.error("Error:",a)}},[C,w]=n.useState(5);let E=()=>t.jsx(F,{}),b=e=>t.jsx(T,{plannedPayment:e});n.useEffect(()=>{o&&w(o.length>0?o.length:3)},[o]);const[m,k]=n.useState("");return n.useEffect(()=>{if(!i){const e=setTimeout(()=>{x(d),l()},500);return()=>{clearTimeout(e)}}},[m]),n.useEffect(()=>{i||l()},[c]),n.useEffect(()=>{if(!i){const e=()=>{setTimeout(()=>{console.log("Dialog Event"),l()},100)};return window.addEventListener("planned-payment.refresh",e),()=>{window.removeEventListener("planned-payment.refresh",e)}}}),t.jsx(t.Fragment,{children:t.jsxs("div",{className:"flex flex-col gap-6",children:[t.jsxs("div",{className:" flex flex-row gap-4",children:[t.jsx(N,{placeholder:"Search by Planned Payment name",value:m,onChange:e=>{k(e.target.value)}}),t.jsx(j,{children:t.jsx("i",{className:"fa-solid fa-filter"})})]}),(()=>{if(y){let e=[];for(let s=0;s<C;s++)e.push(t.jsx("div",{children:E()},`skeleton-${s}`));return e}else{let e=[],s=t.jsx(R,{});return o&&o.length>0&&o.map((r,a)=>{e.push(t.jsx("div",{children:b(r)},`planned_item-${a}`))}),e.length>0?e:s}})(),t.jsx("div",{children:t.jsx(j,{variant:"outline",className:"dark:border-white",disabled:!v,onClick:()=>{g(!1),x(c+d)},children:"Load more"})})]})})}export{M as default};
