import{r as n,j as e,a as ze,d as xe,e as u}from"./app-2aac7c5c.js";import{u as fe,C as pe,f as R,a as he}from"./function-c6b7f042.js";import{u as He,A as Pe}from"./ApplicationLogo-ce464f4f.js";import{I as Ue,E as j,P as be,a as je,C as we,b as ve,c as Ne,d as Ce,S as ge,e as ye,f as ke,g as Se,T as Ge,h as Je}from"./theme-toggle-e77f5c9d.js";import{B as N}from"./button-db0ac17e.js";import{G as Oe}from"./PublicLayout-4e22f184.js";import{C as Ye,a as Ve,e as Ke}from"./card-83c88611.js";import{B as Qe}from"./badge-7b71ef20.js";import{I as Xe}from"./input-d052e0c4.js";/* empty css            */function dt({auth:Ze}){const{toast:Te}=He(),T=Ue(({inputRef:l,...s})=>e.jsx(Xe,{...s,ref:l})),[a,A]=n.useState({}),[c,C]=n.useState(0),[M,Ae]=n.useState(0),D=(l,s)=>{U instanceof AbortController&&U.abort();let t=s.target,o=t.textContent;if(l==="next"){t.tagName.toLowerCase()==="button"&&t.setAttribute("disabled","disabled"),t.innerHTML='<span class=" flex items-center gap-1"><i class="fa-solid fa-spinner fa-spin-pulse"></i>Loading</span>';let r=document.querySelector(".quick-action-item.active");if(r){let d=r.dataset.key;if(d){A({});const b=new AbortController;We(b);let i=new FormData;switch(i.append("key",d),d){case"wallet":{i.append("type",w),i.append("from_wallet",f),i.append("to_wallet",p);break}case"amount":i.append("amount",String(h??0)),i.append("extra_amount",String(v??0)),i.append("extra_type",x)}u.post(route("api.quick-action.v1.record.validation"),i,{cancelToken:new u.CancelToken(function(I){b.abort=I})}).then(m=>(console.log(m),m.status===200&&(m.data,C(c+1)),!0)).catch(m=>{var ce;const I=m;console.log(m);let ie=(ce=I.response)==null?void 0:ce.data;ie.errors&&A(ie.errors),setTimeout(()=>{const de=document.querySelectorAll("#recordDialog-forms .form--group.is--invalid");de.length>0&&Array.from(de).reduce((me,ue)=>me.offsetTop>ue.offsetTop?ue:me).scrollIntoView({behavior:"smooth"})},100)}).finally(()=>{t.tagName.toLowerCase()==="button"&&t.removeAttribute("disabled"),o&&(t.innerHTML=o)})}}}else l==="prev"&&c>0&&C(c-1)},z=()=>{let l=document.getElementById("quick-action-wrapper");if(l){let s=l.querySelector(".quick-action-item.active");if(s){l.style.height=`calc(${s.clientHeight+"px"} + 1.5rem)`;let o=document.getElementById("quick-action-container");o&&(o.style.height=`calc(${s.clientHeight+"px"})`)}let t=l.querySelectorAll(".quick-action-item");if(t.length>0){Ae(t.length-1);for(const o of t)o.style.width=`calc(${l.clientWidth}px)`}}};n.useEffect(()=>{z()}),n.useEffect(()=>{let l=document.getElementById("quick-action-container");if(l){let s=l.querySelectorAll(".quick-action-item");if(s[c]){l.style.transform=`translateX(-${s[c].offsetLeft}px)`;let t=l.querySelector(".quick-action-item.active");t&&t.classList.remove("active"),s[c].classList.add("active"),z()}}},[c]);const H=()=>{G("expense"),Y(""),ee(""),oe(0),ne(0),L("amount"),re("")},[P,_e]=n.useState(null),Fe=l=>{let s=l.target,t=s.textContent;s.tagName.toLowerCase()==="button"&&s.setAttribute("disabled","disabled"),s.innerHTML='<span class=" flex items-center gap-1"><i class="fa-solid fa-spinner fa-spin-pulse"></i>Loading</span>',P instanceof AbortController&&P.abort();const o=new AbortController;_e(o);let r=new FormData;r.append("type",w),r.append("from_wallet",f),r.append("to_wallet",p),r.append("amount",String(h??0)),r.append("extra_amount",String(v??0)),r.append("extra_type",x),r.append("notes",q),r.append("timestamp",he().format("YYYY-MM-DD HH:mm:ss")),r.append("timezone",he.tz.guess()),u.post(route("api.quick-action.v1.record.store"),r,{cancelToken:new u.CancelToken(function(b){o.abort=b})}).then(d=>(d.status===200&&(d.data,Te({title:"Action: Success",description:"Record data successfully saved"}),H(),C(0)),!0)).catch(d=>{var m;let i=(m=d.response)==null?void 0:m.data;i.errors&&A(i.errors)}).finally(()=>{s.tagName.toLowerCase()==="button"&&s.removeAttribute("disabled"),t&&(s.innerHTML=t)})},[U,We]=n.useState(null),[w,G]=n.useState("expense");let J;const[g,O]=n.useState(!1),[f,Y]=n.useState(""),[V,K]=n.useState("Select an option"),[_,Q]=n.useState([]),[F,Ee]=n.useState(""),[Le,X]=n.useState(!1),[y,$e]=n.useState(null),qe=async(l,s)=>{X(!0);try{const t=[],o={keyword:l};for(const r in o)t.push(encodeURIComponent(r)+"="+encodeURIComponent(o[r]));try{return(await u.get(`${route("api.wallet.v1.list")}?${t.join("&")}`,{cancelToken:new u.CancelToken(function(i){s.abort=i})})).data.result.data}catch(r){u.isCancel(r)?console.log("Request was canceled",r):console.error("Error:",r)}}catch(t){throw console.error("Request error:",t),t}return[]};n.useEffect(()=>{if(clearTimeout(J),Q([]),g){y&&y.abort();const l=new AbortController;return $e(l),J=setTimeout(()=>{qe(F,l).then((s=[])=>{X(!1),s&&Q(s)}).catch(s=>{})},0),()=>{y&&y.abort()}}},[F,g]),n.useEffect(()=>{if(f!==""&&_.length>0){const l=_.find(s=>(s==null?void 0:s.uuid)===f);l&&K(l.name)}else K("Select an option")},[f]);let Z;const[k,B]=n.useState(!1),[p,ee]=n.useState(""),[te,ae]=n.useState("Select an option"),[W,se]=n.useState([]),[E,Ie]=n.useState(""),[Re,le]=n.useState(!1),[S,Me]=n.useState(null),De=async(l,s)=>{le(!0);try{const t=[],o={keyword:l};for(const r in o)t.push(encodeURIComponent(r)+"="+encodeURIComponent(o[r]));try{return(await u.get(`${route("api.wallet.v1.list")}?${t.join("&")}`,{cancelToken:new u.CancelToken(function(i){s.abort=i})})).data.result.data}catch(r){u.isCancel(r)?console.log("Request was canceled",r):console.error("Error:",r)}}catch(t){throw console.error("Request error:",t),t}return[]};n.useEffect(()=>{if(clearTimeout(Z),se([]),k){S&&S.abort();const l=new AbortController;return Me(l),Z=setTimeout(()=>{De(E,l).then((s=[])=>{le(!1),s&&se(s)}).catch(s=>{})},500),()=>{S&&S.abort()}}},[E,k]),n.useEffect(()=>{if(p!==""&&W.length>0){const l=W.find(s=>(s==null?void 0:s.uuid)===p);l&&ae(l.name)}else ae("Select an option")},[p]);const[h,oe]=n.useState(),[v,ne]=n.useState(),[x,L]=n.useState("amount"),$=n.useMemo(()=>{let l=h??0,s=v??0;return x==="percentage"&&(s=s*l/100),l+s},[h,v,x]),[q,re]=n.useState("");return e.jsxs(Oe,{children:[e.jsx(ze,{title:"Quick Action: Create new Record"}),e.jsx("div",{className:" flex flex-col justify-center max-md:justify-end max-md:pb-6 items-center h-screen w-screen",children:e.jsxs("main",{className:" w-full md:max-w-[420px] md:min-w-[420px] px-4 md:px-6",children:[e.jsx("div",{className:" mb-4",children:e.jsx(xe,{href:route("sys.index"),children:e.jsx(Pe,{fontSizeMain:" text-3xl"})})}),e.jsxs(Ye,{children:[e.jsx(Ve,{className:" pb-2",children:e.jsx("div",{className:" transition-all duration-300 ease-in-out py-6 relative overflow-x-clip",id:"quick-action-wrapper",children:e.jsx("div",{className:" absolute flex flex-row flex-nowrap gap-12 transition-all duration-300 ease-in-out",id:"quick-action-container",children:(()=>{let l=[{name:"Step 1",key:"wallet",el:e.jsxs("div",{children:[e.jsxs("div",{className:`form-group mb-4 ${a!=null&&a.type?" is--invalid":""}`,children:[e.jsx("div",{className:` flex flex-row gap-4 w-full border p-1 rounded-md ${a!=null&&a.type?" !border-red-500":""}`,id:"record_dialog-type",children:(()=>{let t=[];return["income","transfer","expense"].map((o,r)=>{t.push(e.jsx("div",{className:` w-full text-center py-1 rounded-sm cursor-pointer ${w===o?"bg-primary ":" dark:!text-white !text-black hover:!text-primary-foreground"} text-primary-foreground hover:bg-primary/90 transition`,onClick:()=>{G(o)},children:e.jsx("span",{className:" text-sm font-semibold",children:fe(o)})},`record_type-${o}`))}),t.length>0?t:e.jsx(e.Fragment,{})})()}),e.jsx(j,{message:a==null?void 0:a.category_id})]}),e.jsxs("div",{className:` form--group  ${a!=null&&a.from_wallet?" is--invalid":""}`,id:"record_dialog-from_wallet",children:[e.jsx("label",{className:" form--label",children:"From"}),e.jsxs("div",{children:[e.jsxs(be,{open:g,onOpenChange:O,children:[e.jsx(je,{asChild:!0,children:e.jsxs(N,{variant:"outline",role:"combobox","aria-expanded":g,className:`w-full justify-between ${a!=null&&a.from_wallet?" !border-red-500":""} dark:text-white`,children:[e.jsx("span",{className:" whitespace-nowrap overflow-hidden w-full text-ellipsis text-left font-light",children:V}),e.jsx(we,{className:"ml-2 h-4 w-4 shrink-0 opacity-50"})]})}),e.jsx(ve,{className:" w-[250px] lg:w-[350px] p-0 z-[1000]",align:"start",side:"bottom",children:e.jsxs(Ne,{shouldFilter:!1,children:[e.jsx(Ce,{placeholder:"Search wallet",className:" border-none focus:ring-0",value:F,onValueChange:Ee}),e.jsx(ge,{className:"p-0",children:e.jsxs("div",{className:"max-h-[10rem]",children:[e.jsx(ye,{children:Le?"Loading...":"No wallet found."}),e.jsx(ke,{children:_.map(t=>e.jsxs(Se,{value:t==null?void 0:t.uuid,onSelect:o=>{Y(o===f?"":o),O(!1)},children:[e.jsx(pe,{className:`mr-2 h-4 w-4 ${f===(t==null?void 0:t.uuid)?"opacity-100":"opacity-0"}`}),e.jsx("span",{className:" w-full overflow-hidden whitespace-nowrap text-ellipsis",children:t==null?void 0:t.name})]},t==null?void 0:t.uuid))})]})})]})})]}),e.jsx(j,{message:a==null?void 0:a.from_wallet})]})]}),(()=>w==="transfer"?e.jsxs("div",{className:` form--group  ${a!=null&&a.to_wallet?" is--invalid":""}`,id:"record_dialog-to_wallet",children:[e.jsx("label",{className:" form--label",children:"To"}),e.jsxs("div",{children:[e.jsxs(be,{open:k,onOpenChange:B,children:[e.jsx(je,{asChild:!0,children:e.jsxs(N,{variant:"outline",role:"combobox","aria-expanded":k,className:` w-full justify-between ${a!=null&&a.to_wallet?" !border-red-500":""} dark:text-white`,children:[e.jsx("span",{className:" whitespace-nowrap overflow-hidden w-full text-ellipsis text-left font-light",children:te}),e.jsx(we,{className:"ml-2 h-4 w-4 shrink-0 opacity-50"})]})}),e.jsx(ve,{className:" w-[250px] lg:w-[350px] p-0 z-[1000]",align:"start",side:"bottom",children:e.jsxs(Ne,{shouldFilter:!1,children:[e.jsx(Ce,{placeholder:"Search wallet",className:" border-none focus:ring-0",value:E,onValueChange:Ie}),e.jsx(ge,{className:"p-0",children:e.jsxs("div",{className:"max-h-[10rem]",children:[e.jsx(ye,{children:Re?"Loading...":"No wallet found."}),e.jsx(ke,{children:W.map(t=>e.jsxs(Se,{value:t==null?void 0:t.uuid,onSelect:o=>{ee(o===p?"":o),B(!1)},children:[e.jsx(pe,{className:`mr-2 h-4 w-4 ${p===(t==null?void 0:t.uuid)?"opacity-100":"opacity-0"}`}),e.jsx("span",{className:" w-full overflow-hidden whitespace-nowrap text-ellipsis",children:t==null?void 0:t.name})]},t==null?void 0:t.uuid))})]})})]})})]}),e.jsx(j,{message:a==null?void 0:a.to_wallet})]})]}):e.jsx(e.Fragment,{}))()]})},{name:"Step 2",key:"amount",el:e.jsxs("div",{children:[e.jsxs("div",{className:` form--group  ${a!=null&&a.amount?" is--invalid":""}`,id:"record_dialog-amount",children:[e.jsx("label",{className:"form--label",children:"Amount"}),e.jsx(T,{type:"text",placeholder:"Amount",inputMode:"numeric",value:(h??0).toString(),className:`${a!=null&&a.amount?" !border-red-500":""}`,mask:Number,unmask:!0,thousandsSeparator:",",scale:2,radix:".",onBlur:t=>{let o=t.target.value;o=o.replace(",",""),oe(Number(o))}}),e.jsx(j,{message:a==null?void 0:a.amount})]}),e.jsxs("div",{className:" flex flex-col w-full",children:[e.jsx("div",{className:` form--group  ${a!=null&&a.extra_amount?" is--invalid":""}`,id:"record_dialog-extra_amount",children:e.jsxs("div",{className:" flex flex-col gap-1",children:[e.jsxs("div",{id:"record_dialog-extra_amount",children:[e.jsx("label",{className:" form--label",children:"Extra"}),e.jsx(T,{type:"text",placeholder:"Extra Amount",inputMode:"numeric",value:(v??0).toString(),className:`${a!=null&&a.extra_amount?" !border-red-500":""}`,mask:Number,unmask:!0,thousandsSeparator:",",scale:2,radix:".",onBlur:t=>{let o=t.target.value;o=o.replace(",",""),ne(Number(o))}}),e.jsx(j,{message:a==null?void 0:a.extra_amount})]}),e.jsx("div",{id:"record_dialog-extra_type",children:e.jsxs("span",{className:" text-sm flex flex-row gap-1",children:[e.jsx("span",{className:` cursor-pointer ${x==="amount"?" font-semibold":""}`,onClick:()=>{x!=="amount"&&L("amount")},children:"Amount"}),e.jsx("span",{children:"/"}),e.jsx("span",{className:` cursor-pointer ${x==="percentage"?" font-semibold":""}`,onClick:()=>{x!=="percentage"&&L("percentage")},children:"Percentage"})]})})]})}),e.jsxs("div",{className:` form--group  ${a!=null&&a.final_amount?" is--invalid":""}`,id:"record_dialog-final_amount",children:[e.jsx("label",{className:" form--label",children:"Final"}),e.jsx(T,{type:"text",placeholder:"Final Amount",inputMode:"numeric",value:($??0).toString(),className:`${a!=null&&a.final_amount?" !border-red-500":""}`,mask:Number,unmask:!0,thousandsSeparator:",",scale:2,radix:".",disabled:!0}),e.jsx(j,{message:a==null?void 0:a.final_amount})]})]})]})},{name:"Step 3",key:"note",el:e.jsx("div",{children:e.jsxs("div",{className:` form--group  ${a!=null&&a.notes?" is--invalid":""}`,id:"record_dialog-note",children:[e.jsx("label",{className:" form--label",children:"Note"}),e.jsx(Ge,{className:` w-full ${a!=null&&a.notes?" !border-red-500":""}`,placeholder:"Type your message here.",value:q,onChange:t=>{re(t.target.value)}}),e.jsx(j,{message:a==null?void 0:a.notes})]})})},{name:"Step 4",key:"review",el:e.jsxs("div",{className:" mb-4",children:[e.jsxs("div",{className:" mb-4",children:[e.jsx("span",{className:" block font-semibold",children:"Type"}),e.jsx(Qe,{children:fe(w)})]}),e.jsxs("div",{className:" flex flex-row justify-between gap-4",children:[e.jsxs("div",{className:" w-full overflow-hidden",children:[e.jsx("span",{className:" block font-semibold",children:"From Wallet"}),e.jsx("span",{className:" block whitespace-nowrap overflow-hidden w-full text-ellipsis",children:V})]}),(()=>w==="transfer"?e.jsxs("div",{className:" w-full overflow-hidden text-right",children:[e.jsx("span",{className:" block font-semibold",children:"To Wallet"}),e.jsx("span",{className:" whitespace-nowrap",children:te})]}):e.jsx(e.Fragment,{}))()]}),e.jsxs("div",{className:" w-full p-4 rounded-lg border-2 border-dashed mt-4",children:[e.jsxs("span",{className:" flex items-center gap-2 text-sm",children:[e.jsx("i",{className:"fa-solid fa-align-left"}),e.jsx("strong",{children:"Note(s)"})]}),e.jsx("span",{className:" block mt-2",children:q??"No description provided"})]}),e.jsxs("div",{className:"mt-4",children:[e.jsxs("div",{className:"flex justify-between mt-2 text-sm",children:[e.jsx("span",{children:"Amount"}),e.jsx("span",{"data-review":"amount",children:R(h??0)})]}),e.jsxs("div",{className:"flex justify-between mt-1 text-sm",children:[e.jsxs("span",{children:[e.jsx("span",{children:"Extra"}),(()=>x==="percentage"?e.jsxs("span",{className:"text-xs",children:["(",v??0,"%)"]}):e.jsx(e.Fragment,{}))()]}),e.jsx("span",{"data-review":"extra_amount",children:R(($??0)-(h??0))})]}),e.jsx("hr",{className:"my-1"}),e.jsxs("div",{className:"flex justify-between mt-2",children:[e.jsx("span",{className:"font-semibold",children:"Final Amount"}),e.jsx("span",{className:"font-semibold","data-review":"final_amount",children:R($??0)})]})]})]})}],s=[];return l.forEach((t,o)=>{s.push(e.jsx("section",{className:`quick-action-item ${o===0?"active":""} flex flex-col h-[fit-content] px-1`,"data-key":t.key,children:t.el},`wizzard-step_${o}`))}),s})()})})}),e.jsx(Ke,{children:e.jsxs("div",{className:" flex justify-between w-full gap-4",children:[e.jsx("div",{className:" w-5/12",children:e.jsx(N,{variant:"outline",className:c===0?" !opacity-0":"",disabled:c===0,onClick:l=>{D("prev",l)},children:"Prev"})}),(()=>c>0?e.jsx(N,{variant:"ghost",className:"w-3/12",onClick:l=>{H(),C(0)},children:e.jsx("span",{className:"text-destructive",children:"Reset"})}):e.jsx(e.Fragment,{}))(),e.jsx("div",{className:" w-5/12 flex flex-col items-end",children:(()=>c===M?e.jsx(N,{className:" w-full",onClick:l=>{Fe(l)},children:"Submit"}):e.jsx(N,{variant:"outline",disabled:c===M,onClick:l=>{D("next",l)},children:"Next"}))()})]})})]}),e.jsxs("div",{className:" mt-10 flex flex-col gap-6 w-full text-center",children:[e.jsx(xe,{href:route("sys.index"),className:"dark:text-white",children:"Go to Dashboard"}),e.jsx("div",{className:" flex flex-row gap-4 rounded border p-2 dark:text-white",children:e.jsx(Je,{className:" flex flex-row gap-2 w-full"})})]})]})})]})}export{dt as default};
