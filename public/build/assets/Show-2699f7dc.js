import{r as i,e as w,j as e,a as te,y as g,d as y}from"./app-f9c29e53.js";import{u as ne,B as x}from"./button-85bb5282.js";import{u as O,f as C,h as o}from"./check-0c8c6a9d.js";import{T as re}from"./TemplateBackButton-1bb3f5ca.js";import{D as ie,a as oe,b as ae,c as S,T as ce}from"./TemplateNoData-f068f40d.js";import{S as de}from"./SystemLayout-863cb355.js";import{T as xe,S as ue}from"./SkeletonList-abafa668.js";import{C as k,b as E,c as T,d as me,a as R}from"./card-719678ad.js";import{B as c}from"./badge-49643a96.js";import{S as he}from"./separator-1b3de91d.js";import{I as fe}from"./input-7b73f046.js";/* empty css            */import"./index-b260e8f0.js";/* empty css              */import"./ApplicationLogo-c2b51e2d.js";import"./scroll-area-ad41c8b0.js";import"./theme-toggle-32a54062.js";import"./ApplicationLogoMask-1e4a3b0a.js";import"./skeleton-855f6bb4.js";function $e({auth:U,data:s,original_start:h,original_end:ge,previous_start:d,previous_end:L,range:D,usage_limit:f,usage_used:P,usage_remaining:u}){const Y=ne(),[q,I]=i.useState(!1),j=(l="prev")=>{let t=null;l==="prev"?t=Number(D)+1:l==="next"&&(t=Number(D)-1);let n={uuid:s.uuid};t&&t>0&&(n.previous=t);let r=route("sys.budget.show",n);g.visit(r,{preserveScroll:!0})},[p,K]=i.useState("");i.useEffect(()=>{W()},[p]);const W=()=>{if(!Y){const l=setTimeout(()=>{B(v),N()},500);return()=>{clearTimeout(l)}}},z=l=>e.jsx(xe,{record:l});let G=e.jsx(ue,{}),v=5;const[_,J]=i.useState(0),[M,Q]=i.useState(0),[b,B]=i.useState(v),[V,F]=i.useState(!1);i.useEffect(()=>{N()},[b]);const[X,$]=i.useState(!0),[Z,ee]=i.useState(5),[m,se]=i.useState([]),[H,A]=i.useState(null);i.useEffect(()=>{ee(m.length>0?m.length:3)},[m]);const N=async()=>{H instanceof AbortController&&H.abort();const l=new AbortController;A(l),$(!0);const t=[],n={limit:b,keyword:p,filter_budget:s.uuid,filter_start:d,filter_end:L};for(const r in n)t.push(encodeURIComponent(r)+"="+encodeURIComponent(n[r]));try{let a=(await w.get(`${route("api.record.v1.list")}?${t.join("&")}`,{cancelToken:new w.CancelToken(function(le){l.abort=le})})).data;se(a.result.data),F(a.result.has_more),J(a.result.data.length),"total"in a.result&&Q(a.result.total),$(!1),A(null)}catch(r){w.isCancel(r)?console.log("Request was canceled",r):console.error("Error:",r)}};return i.useEffect(()=>{const l=t=>{var n,r;(n=t.detail)!=null&&n.action&&((r=t.detail)==null?void 0:r.action)==="delete"?g.visit(route("sys.budget.index")):(N(),g.reload())};return document.addEventListener("budget.deleted-action",l),document.addEventListener("dialog.budget.hidden",l),document.addEventListener("dialog.record.hidden",l),()=>{document.addEventListener("budget.deleted-action",l),document.removeEventListener("dialog.budget.hidden",l),document.removeEventListener("dialog.record.hidden",l)}}),e.jsx(e.Fragment,{children:e.jsxs(de,{user:U.user,header:e.jsxs("h2",{className:"font-semibold text-xl text-gray-800 leading-tight",children:["Budget Detail: ",`${s==null?void 0:s.name}`]}),fabAction:["budget"],children:[e.jsx(te,{title:`Budget: ${s==null?void 0:s.name}`}),e.jsx(re,{className:"px-0"}),e.jsxs("div",{className:" flex flex-col gap-6",children:[e.jsxs(k,{className:" w-full",children:[e.jsx(E,{children:e.jsxs("div",{className:" relative flex flex-row gap-4 justify-between items-start",children:[e.jsxs("div",{children:[e.jsx(T,{children:e.jsxs("div",{children:["Budget Detail: ",`${s==null?void 0:s.name}`]})}),e.jsx(me,{children:"See summary of your budget"})]}),e.jsx("div",{children:e.jsxs(ie,{open:q,onOpenChange:I,children:[e.jsx(oe,{asChild:!0,children:e.jsx(x,{variant:"link",className:" p-0 h-auto leading-none dark:!text-white !text-black","data-type":"dropdown-trigger",children:e.jsx("i",{className:"fa-solid fa-ellipsis-vertical"})})}),e.jsxs(ae,{sideOffset:5,alignOffset:0,side:"left",align:"start",children:[e.jsx(S,{className:" cursor-pointer",onClick:()=>{g.reload(),setTimeout(()=>{I(!1)},100)},children:e.jsx("span",{className:"",children:"Refresh"})}),(()=>document.getElementById("budget-dialogSection")?e.jsx(S,{className:" cursor-pointer",onClick:t=>{let n=t.target;if(n){let r=n.innerHTML;n.innerHTML='<span class=" flex items-center gap-1"><i class="fa-solid fa-spinner fa-spin-pulse"></i>Loading</span>';const a=()=>{r&&(n.innerHTML=r),document.removeEventListener("dialog.budget.shown",a)};document.addEventListener("dialog.budget.shown",a)}document.dispatchEvent(new CustomEvent("budget.edit-action",{bubbles:!0,detail:{uuid:s&&"uuid"in s?s==null?void 0:s.uuid:""}}))},children:e.jsx("span",{className:" text-yellow-500",children:"Edit"})}):e.jsx(e.Fragment,{}))(),(()=>document.getElementById("budget-deleteDialogSection")?e.jsx(S,{className:" cursor-pointer",onClick:()=>{document.dispatchEvent(new CustomEvent("budget.delete-action",{bubbles:!0,detail:{uuid:s&&"uuid"in s?s==null?void 0:s.uuid:null,action:"delete"}}))},children:e.jsx("span",{className:" text-red-500",children:"Delete"})}):e.jsx(e.Fragment,{}))()]})]})})]})}),e.jsx(R,{children:e.jsxs("div",{className:" flex flex-col gap-6",children:[e.jsxs("div",{className:" flex flex-row justify-between",children:[e.jsxs("div",{className:" flex flex-col gap-1",children:[e.jsx("span",{children:"Occurence"}),e.jsx(c,{variant:"outline",children:O(s.occurence)})]}),e.jsxs("div",{className:" flex flex-col gap-1",children:[e.jsx("span",{children:"Interval"}),e.jsx(c,{variant:"outline",children:s.occurence==="once"?s.interval:O(s.interval)})]})]}),e.jsxs("div",{className:" w-full p-4 rounded-lg border-2 border-dashed",children:[e.jsxs("span",{className:" flex items-center gap-2 text-sm font-normal",children:[e.jsx("i",{className:"fa-solid fa-align-left"}),e.jsx("span",{className:"font-normal",children:"Note(s)"})]}),e.jsx("span",{className:" block mt-2",children:s.description??"No description provided"})]})]})})]}),e.jsxs(k,{className:" w-full",children:[e.jsx(E,{children:e.jsx("div",{className:" relative flex flex-row gap-4 justify-between items-start",children:e.jsx("div",{children:e.jsx(T,{children:e.jsx("div",{children:"Condition"})})})})}),e.jsx(R,{children:(()=>{if(s.budget_category&&s.budget_category.length>0||s.budget_wallet&&s.budget_wallet.length>0||s.budget_tags&&s.budget_tags.length>0){let l=[];if(s.budget_category&&s.budget_category.length>0){let t=[];s.budget_category.forEach((n,r)=>{t.push(e.jsx(y,{href:route("sys.category.show",n.uuid),children:e.jsx(c,{children:n.name})},`category_badge_link-${r}`))}),l.push(e.jsxs("div",{className:" flex flex-col gap-1",children:[e.jsxs("span",{className:" leading-none",children:["Category (",s.budget_category.length,")"]}),e.jsx("div",{className:" flex flex-row gap-1 flex-wrap",children:t})]},"condition-category"))}if(s.budget_wallet&&s.budget_wallet.length>0){let t=[];s.budget_wallet.forEach((n,r)=>{t.push(e.jsx(y,{href:route("sys.wallet.show",n.uuid),children:e.jsx(c,{children:n.name})},`wallet_badge_link-${r}`))}),l.push(e.jsxs("div",{className:" flex flex-col gap-1",children:[e.jsxs("span",{className:" leading-none",children:["Wallet (",s.budget_wallet.length,")"]}),e.jsx("div",{className:" flex flex-row gap-1 flex-wrap",children:t})]},"condition-wallet"))}if(s.budget_tags&&s.budget_tags.length>0){let t=[];s.budget_tags.forEach((n,r)=>{t.push(e.jsx(y,{href:route("sys.tags.show",n.uuid),children:e.jsx(c,{children:n.name})},`tags_badge_link-${r}`))}),l.push(e.jsxs("div",{className:" flex flex-col gap-1",children:[e.jsxs("span",{className:" leading-none",children:["Tags (",s.budget_tags.length,")"]}),e.jsx("div",{className:" flex flex-row gap-1 flex-wrap",children:t})]},"condition-tags"))}return e.jsx("div",{className:" flex flex-col gap-4",children:l})}return e.jsx("span",{children:"No condition provided"})})()})]}),e.jsxs(k,{className:" w-full",children:[e.jsx(E,{children:e.jsx("div",{className:" relative flex flex-row gap-4 justify-between items-start",children:e.jsx("div",{children:e.jsx(T,{children:e.jsx("div",{children:"Usage"})})})})}),e.jsxs(R,{className:" flex flex-col gap-4",children:[e.jsxs("div",{className:" flex flex-col gap-2",children:[e.jsxs("div",{className:" flex flex-row justify-between",children:[e.jsxs("div",{className:" flex flex-col",children:[e.jsx("small",{children:"Used"}),e.jsx("span",{children:C(P)})]}),e.jsxs("div",{className:" flex flex-col items-end",children:[e.jsx("small",{children:"Remaining"}),e.jsx("span",{children:C(u)})]})]}),e.jsx("div",{className:" h-3 w-full rounded-full relative bg-gray-100 dark:bg-gray-700 overflow-hidden",children:e.jsx("div",{className:" h-full w-full absolute left-0 top-0 bg-primary",style:{width:`${u&&f?u/f*100:100}%`}})}),e.jsxs("div",{className:" flex flex-row justify-between",children:[e.jsxs(c,{variant:"outline",children:["Limit: ",C(s.amount)]}),e.jsxs(c,{variant:"outline",children:["Usage: ",`${(100-(u&&f?u/f*100:100)).toFixed(2)}%`]})]})]}),e.jsx(he,{}),e.jsxs("div",{className:" flex flex-col gap-4",children:[e.jsxs("div",{className:" flex flex-col gap-1",children:[e.jsxs("div",{className:" flex flex-col gap-1",children:[e.jsxs("div",{className:" flex flex-row justify-between",children:[e.jsx("div",{className:"",children:e.jsx(x,{variant:"ghost",onClick:()=>{j("prev")},children:e.jsx("span",{children:e.jsx("i",{className:"fa-solid fa-angle-left"})})})}),e.jsx("div",{className:"",children:e.jsx(x,{variant:"outline",className:"px-6",children:o(d)<o(h)?"Archive":"Current"})}),e.jsx("div",{className:"",children:e.jsx(x,{variant:"ghost",onClick:()=>{j("next")},className:o(d)<o(h)?"":" !opacity-0",disabled:!(o(d)<o(h)),children:e.jsx("span",{children:e.jsx("i",{className:"fa-solid fa-angle-right"})})})})]}),(()=>o(d)<o(h)?e.jsx("div",{className:" flex flex-row justify-center",children:e.jsx(x,{variant:"link",className:" h-auto py-0",onClick:()=>{j("curr")},children:"Back to current period"})}):e.jsx(e.Fragment,{}))()]}),e.jsxs("div",{className:" flex flex-row justify-between",children:[e.jsxs("div",{className:" flex flex-col gap-1",children:[e.jsx("span",{className:" text-sm leading-none",children:"From"}),e.jsx("span",{className:" font-medium leading-tight",children:o(d).format("MMM Do, 'YY / HH:mm")})]}),e.jsxs("div",{className:" flex flex-col gap-1 items-end",children:[e.jsx("span",{className:" text-sm leading-none",children:"Until"}),e.jsx("span",{className:" font-medium leading-tight",children:o(L).format("MMM Do, 'YY / HH:mm")})]})]})]}),e.jsxs("div",{className:" flex flex-col gap-2",children:[e.jsx(fe,{placeholder:"Search by record notes",value:p,onChange:l=>{K(l.target.value)}}),e.jsx("div",{className:" flex flex-col gap-4",children:(()=>{if(X){let l=[];for(let t=0;t<Z;t++)l.push(e.jsx("div",{children:G},`skeleton-${t}`));return l}else{let l=[],t=e.jsx(ce,{});return m.length>0&&m.map((n,r)=>{l.push(e.jsx("div",{children:z(n)},`record_item-${r}`))}),l.length>0?l:t}})()}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx(x,{variant:"outline",className:"",disabled:!V,onClick:()=>{F(!1),B(b+v)},children:"Load more"}),(()=>_>0&&M>0?e.jsx(e.Fragment,{children:e.jsxs("span",{className:"text-sm",children:["Showing ",_," of ",M," entries"]})}):e.jsx(e.Fragment,{}))()]})]})]})]})]})]})]})})}export{$e as default};
