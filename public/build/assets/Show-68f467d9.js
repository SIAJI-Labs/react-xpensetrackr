import{r as l,j as e,d as J,e as k,a as K,y as Q}from"./app-c73dabb8.js";import{B as h,u as V}from"./button-92a351e5.js";import{a as v,m as x,f as b,u as _,b as W}from"./Combination-71219a6c.js";import{D as $,a as y,b as M,c as F}from"./dropdown-menu-e60c836d.js";import{B as A}from"./badge-1ae7df27.js";import{S as X,L as Z}from"./separator-3a2a02a6.js";import{B as P}from"./BackButtonTemplate-dcedb0c6.js";import{N as ee}from"./skeleton-ecd68c20.js";import{A as se,a as re,b as te,c as ne,d as ie,e as le,S as oe}from"./SystemLayout-21bd8a52.js";import{C as S,b as ce,c as ae,d as de,a as T,e as xe}from"./card-e976dd91.js";import"./ApplicationLogo-e8c8c069.js";import"./ApplicationLogoMask-6b112cd9.js";import"./textarea-69590a08.js";import"./input-cdd90984.js";function me({plannedPayment:r}){let s=(Math.random()+1).toString(36).substring(7);const[g,j]=l.useState(!1);return e.jsx(e.Fragment,{children:(()=>{var a,u;return r.status==="approve"?e.jsx("section",{onClick:N=>{j(!0)},children:e.jsxs("div",{className:" flex flex-col gap-2 border rounded-lg p-4 cursor-pointer",children:[e.jsxs("div",{className:" flex flex-row gap-6 justify-between",children:[e.jsx("span",{className:" font-medium w-full md:w-auto",children:v("MMM Do, YYYY",r&&"period"in r?x(r==null?void 0:r.period):x())}),e.jsxs("div",{className:" flex flex-row flex-1 md:flex-none justify-between gap-2 items-center",children:[e.jsx("span",{className:` font-normal whitespace-nowrap ${r&&"type"in r.record?(r==null?void 0:r.record.type)==="expense"?" text-red-500":"text-green-500":""}`,children:b(r&&"amount"in r.record&&"extra_amount"in r.record?((a=r==null?void 0:r.record)==null?void 0:a.amount)+((u=r==null?void 0:r.record)==null?void 0:u.extra_amount):0)}),e.jsx("div",{children:e.jsxs($,{open:g,onOpenChange:j,children:[e.jsx(y,{asChild:!0,children:e.jsx(h,{variant:"link",className:" p-0 h-auto leading-none dark:!text-white !text-black","data-type":"dropdown-trigger",children:e.jsx("i",{className:"fa-solid fa-ellipsis-vertical"})})}),e.jsx(M,{sideOffset:5,alignOffset:0,side:"left",align:"start",children:(()=>r&&"uuid"in r.record?e.jsx(e.Fragment,{children:e.jsx(J,{href:route("sys.record.show",{uuid:r.record.uuid}),children:e.jsx(F,{className:" cursor-pointer",children:e.jsx("span",{className:" text-blue-500",children:"Detail"})})})}):e.jsx(e.Fragment,{}))()})]})})]})]}),e.jsxs("div",{className:" flex flex-row gap-4 items-center",children:[e.jsx("div",{className:` p-3 h-10 w-10 rounded-full ${r&&"type"in r.record?r.record.type==="income"?" bg-green-500":r.record.type==="expense"?" bg-red-500":" bg-gray-500 dark:bg-secondary":""} flex items-center justify-center`,children:e.jsx("i",{className:` text-white fa-solid ${r&&"type"in r.record?r.record.type==="income"?"fa-right-to-bracket rotate-90":r.record.type==="expense"?"fa-right-from-bracket -rotate-90":"fa-right-left rotate-90":""}`})}),e.jsxs("div",{className:" w-full flex flex-col overflow-hidden",children:[e.jsx("span",{className:" whitespace-nowrap overflow-hidden text-ellipsis font-medium",children:(()=>r&&"category_id"in r.record&&r.record.category?e.jsx(e.Fragment,{children:`${r.record.category.parent?`${r.record.category.parent.name} - `:""}${r.record.category.name}`}):e.jsx(e.Fragment,{children:"Uncategorized"}))()}),e.jsx("span",{className:" whitespace-nowrap text-sm overflow-hidden text-ellipsis",children:r&&"note"in r.record?r.record.note:"No description"})]})]}),e.jsx("div",{className:" mt-2",children:e.jsxs("span",{className:" text-sm italic",children:["You're performing this action at ",v("MMM Do, YYYY / HH:mm",r&&"created_at"in r?x(r==null?void 0:r.created_at):x())]})})]})},s):e.jsx(e.Fragment,{children:e.jsx("section",{children:e.jsxs("div",{className:" flex flex-col gap-2 border rounded-lg p-4 cursor-pointer",children:[e.jsxs("div",{className:" flex flex-row gap-6 justify-between",children:[e.jsx("span",{className:" font-medium w-full md:w-auto",children:v("MMM Do, YYYY",r&&"period"in r?x(r==null?void 0:r.period):x())}),e.jsx(A,{variant:"destructive",children:"Skipped"})]}),e.jsx("div",{className:" mt-2",children:e.jsxs("span",{className:" text-sm italic",children:["You're performing this action at ",v("MMM Do, YYYY / HH:mm",r&&"created_at"in r?x(r==null?void 0:r.created_at):x())]})})]})},s)})})()})}function fe({openState:r,setOpenState:s}){const[g,j]=l.useState();l.useEffect(()=>{const m=n=>{var o;if(console.log(n),(o=n==null?void 0:n.detail)!=null&&o.uuid){let w=n.detail.uuid;j(w),s&&setTimeout(()=>{s(!0)},100)}};return window.addEventListener("planned-payment.record.skip",m),()=>{window.removeEventListener("planned-payment.record.skip",m)}},[]);const[a,u]=l.useState(null),N=m=>{let n=m.target;if(n&&(n.tagName.toLowerCase()==="button"&&n.setAttribute("disabled","disabled"),n.innerHTML='<span class=" flex items-center gap-1"><i class="fa-solid fa-spinner fa-spin-pulse"></i>Loading</span>'),g){a instanceof AbortController&&a.abort();const o=new AbortController;u(o);let w=new FormData;w.append("_method","DELETE"),k.post(route("api.planned-payment.v1.destroy",{uuid:g,action:"skip"}),w,{cancelToken:new k.CancelToken(function(C){o.abort=C})}).then(p=>{p.status===200&&(p.data,setTimeout(()=>{s&&(n&&(n.tagName.toLowerCase()==="button"&&n.removeAttribute("disabled"),n.innerHTML="Continue"),document.dispatchEvent(new CustomEvent("planned-payment.record.skipped",{bubbles:!0,detail:{action:"delete"}})),s(!1))},200))}).catch(p=>{})}};return e.jsx("section",{id:"plannedRecordSkipDialog-section",children:e.jsx(se,{open:r,onOpenChange:s,children:e.jsxs(re,{children:[e.jsxs(te,{children:[e.jsx(ne,{className:"dark:text-white",children:"Are you sure want to skip this period?"}),e.jsx(ie,{children:e.jsx("span",{children:"This action cannot be undone"})})]}),e.jsxs(le,{children:[e.jsx(h,{variant:"ghost",className:"dark:text-gray-200",onClick:m=>{s&&s(!1),a instanceof AbortController&&a.abort()},children:"Cancel"}),e.jsx(h,{onClick:m=>{N(m)},children:"Continue"})]})]})})})}function Se({auth:r,data:s}){const g=V(),[j,a]=l.useState(!1);l.useEffect(()=>{const t=()=>{Q.reload(),L()};return document.addEventListener("dialog.planned-payment.hidden",t),document.addEventListener("dialog.record.hidden",t),document.addEventListener("planned-payment.record.skipped",t),()=>{document.removeEventListener("dialog.planned-payment.hidden",t),document.removeEventListener("dialog.record.hidden",t),document.removeEventListener("planned-payment.record.skipped",t)}}),l.useEffect(()=>{L()},[]);const[u,N]=l.useState(null),[m,n]=l.useState(!0),[o,w]=l.useState();let p=5;const[C,Y]=l.useState(p),[R,E]=l.useState(!1),L=async()=>{n(!0),u instanceof AbortController&&u.abort();const t=new AbortController;N(t);const d=[],c={limit:C};for(const i in c)d.push(encodeURIComponent(i)+"="+encodeURIComponent(c[i]));try{let f=(await k.get(`${route("api.planned-payment.v1.show",s.uuid)}?${d.join("&")}`,{cancelToken:new k.CancelToken(function(G){t.abort=G})})).data,D=f.result.record.data;w(D),E(f.result.has_more),n(!1),N(null)}catch(i){k.isCancel(i)?console.log("Request was canceled",i):console.error("Error:",i)}},[H,I]=l.useState(5);let B=()=>e.jsx(Z,{}),O=t=>e.jsx(me,{plannedPayment:t});l.useEffect(()=>{!g&&o&&I(o.length>0?o.length:5)},[o]);const[U,q]=l.useState(!1),z=t=>{q(t)};return e.jsx(e.Fragment,{children:e.jsxs(oe,{user:r.user,header:e.jsxs("h2",{className:"font-semibold text-xl text-gray-800 leading-tight",children:["Planned Detail: ",`${s==null?void 0:s.name}`]}),children:[e.jsx(K,{title:`Planned Detail: ${s==null?void 0:s.name}`}),e.jsx(fe,{openState:U,setOpenState:z}),e.jsx("div",{className:"flex flex-col gap-6",children:e.jsx(P,{className:"px-0"})}),e.jsxs("div",{className:" flex flex-col gap-6",children:[e.jsxs(S,{className:" w-full",children:[e.jsx(ce,{children:e.jsxs("div",{className:" relative flex flex-row justify-between items-start cursor-pointer",onClick:()=>{a(!0)},children:[e.jsxs("div",{children:[e.jsx(ae,{children:e.jsx("div",{children:"Planned Payment: Detail"})}),e.jsx(de,{children:"See your detailed Planned Payment"})]}),e.jsx("div",{children:e.jsxs($,{open:j,onOpenChange:a,children:[e.jsx(y,{asChild:!0,children:e.jsx(h,{variant:"link",className:" p-0 h-auto leading-none dark:!text-white !text-black","data-type":"dropdown-trigger",children:e.jsx("i",{className:"fa-solid fa-ellipsis-vertical"})})}),e.jsx(M,{sideOffset:5,alignOffset:0,side:"left",align:"start",children:(()=>document.getElementById("plannedPaymentDialog-section")?e.jsx(F,{className:" cursor-pointer",onClick:d=>{let c=d.target;if(c){let i=c.innerHTML;c.innerHTML='<span class=" flex items-center gap-1"><i class="fa-solid fa-spinner fa-spin-pulse"></i>Loading</span>';const f=()=>{i&&(c.innerHTML=i),document.removeEventListener("dialog.planned-payment.shown",f)};document.addEventListener("dialog.planned-payment.shown",f)}document.dispatchEvent(new CustomEvent("plannedPaymentDialogEditAction",{bubbles:!0,detail:{uuid:s==null?void 0:s.uuid}}))},children:e.jsx("span",{className:" text-yellow-500",children:"Edit"})}):e.jsx(e.Fragment,{}))()})]})})]})}),e.jsxs(T,{className:" flex flex-col gap-6",children:[e.jsx("div",{className:" flex flex-row gap-2",children:e.jsx("span",{className:" font-medium text-xl",children:s.name})}),e.jsxs("div",{className:" flex gap-4",children:[e.jsx("div",{className:" w-1/3",children:e.jsxs("div",{className:` border ${s.to_wallet?"":s.type==="income"?" border-green-500":"  border-red-500"} rounded-md h-full flex flex-col gap-2 justify-center items-center`,children:[e.jsx("div",{className:"",children:(()=>s.to_wallet?e.jsx("i",{className:" text-2xl fa-solid fa-arrow-right-arrow-left rotate-90"}):e.jsx("i",{className:`text-2xl fa-solid ${s.type==="income"?" text-green-500 fa-right-to-bracket rotate-90":" text-red-500 fa-right-from-bracket -rotate-90"}`}))()}),e.jsxs("div",{className:" flex flex-col justify-center",children:[e.jsx("span",{className:"font-normal text-center",children:s.to_wallet?"Transfer":_(s.type)}),(()=>s.to_wallet?e.jsxs("span",{className:" text-xs text-center",children:["(",_(s.type),")"]}):e.jsx(e.Fragment,{}))()]})]})}),e.jsxs("div",{className:" w-2/3",children:[e.jsxs("div",{className:"",children:[e.jsx("span",{className:"font-semibold underline text-sm",children:"Category"}),e.jsx("span",{className:"block whitespace-nowrap overflow-hidden text-ellipsis",children:s.category?`${s.category.parent?`${s.category.parent.name} - `:""}${s.category.name}`:"Uncategorized"})]}),e.jsxs("div",{className:"",children:[e.jsx("span",{className:"font-semibold underline text-sm",children:"From"}),e.jsx("span",{className:"block whitespace-nowrap overflow-hidden text-ellipsis",children:s.from_wallet?`${s.from_wallet.parent?`${s.from_wallet.parent.name} - `:""}${s.from_wallet.name}`:"-"})]}),(()=>s.to_wallet?e.jsx(e.Fragment,{children:e.jsxs("div",{className:"",children:[e.jsx("span",{className:"font-semibold underline text-sm",children:"To"}),e.jsx("span",{className:"block whitespace-nowrap overflow-hidden text-ellipsis",children:s.to_wallet?`${s.to_wallet.parent?`${s.to_wallet.parent.name} - `:""}${s.to_wallet.name}`:"-"})]})}):e.jsx(e.Fragment,{}))()]})]}),e.jsxs("div",{className:" w-full p-4 rounded-lg border-2 border-dashed",children:[e.jsxs("span",{className:" flex items-center gap-2 text-sm font-normal",children:[e.jsx("i",{className:"fa-solid fa-align-left"}),e.jsx("span",{className:"font-normal",children:"Note(s)"})]}),e.jsx("span",{className:" block mt-2",children:s.note??"No description provided"})]}),e.jsxs("div",{className:"",children:[e.jsxs("div",{className:"flex justify-between mt-2 text-sm",children:[e.jsx("span",{children:"Amount"}),e.jsx("span",{"data-review":"amount",children:b(s.amount??0)})]}),e.jsxs("div",{className:"flex justify-between mt-1 text-sm",children:[e.jsxs("span",{children:[e.jsx("span",{children:"Extra"}),(()=>s.extra_type==="percentage"?e.jsxs("span",{className:"text-xs",children:["(",s.extra_percentage??0,"%)"]}):e.jsx(e.Fragment,{}))()]}),e.jsx("span",{"data-review":"extra_amount",children:b(s.extra_amount)})]}),e.jsx("hr",{className:"my-1"}),e.jsxs("div",{className:"flex justify-between mt-2",children:[e.jsx("span",{className:"font-semibold",children:"Final Amount"}),e.jsx("span",{className:"font-semibold","data-review":"final_amount",children:b(s.amount+s.extra_amount)})]})]})]})]}),e.jsxs(S,{className:" w-full",children:[e.jsxs(T,{className:" flex flex-col gap-6 pt-6",children:[e.jsxs("div",{className:" flex flex-row justify-between",children:[e.jsxs("div",{className:" flex flex-col gap-1",children:[e.jsx("span",{className:" font-normal",children:_(s.repeat_type)}),e.jsx(A,{children:_(s.repeat_period)})]}),(()=>s.repeat_type==="recurring"?e.jsx(e.Fragment,{children:e.jsxs("div",{className:" flex flex-col gap-1 text-right",children:[e.jsx("span",{className:" font-normal",children:"Every"}),e.jsxs("span",{className:"",children:[s.repeat_frequency," ",W(s.repeat_period)]})]})}):e.jsx(e.Fragment,{}))()]}),e.jsx(X,{}),(()=>{if(m){let t=[];for(let d=0;d<H;d++)t.push(e.jsx("div",{children:B()},`skeleton-${d}`));return t}else{let t=[],d=e.jsx(ee,{});return t.push(e.jsx("div",{children:e.jsx("section",{children:e.jsxs("div",{className:" flex flex-col gap-2 border rounded-lg p-4 cursor-pointer",children:[e.jsxs("div",{className:" flex flex-row gap-6 justify-between",children:[e.jsx("span",{className:" font-medium w-full md:w-auto",children:v("MMM Do, YYYY",s&&"date_start"in s?x(s==null?void 0:s.date_start):x())}),e.jsx("div",{className:" flex flex-row flex-1 md:flex-none justify-between gap-2 items-center",children:e.jsx("span",{className:` font-normal whitespace-nowrap ${s&&"type"in s?(s==null?void 0:s.type)==="expense"?" text-red-500":s.type==="income"?"text-green-500":" dark:text-white":""}`,children:b(s&&"amount"in s&&"extra_amount"in s?(s==null?void 0:s.amount)+(s==null?void 0:s.extra_amount):0)})})]}),e.jsxs("div",{className:" flex flex-row gap-4 items-center",children:[e.jsx("div",{className:` p-3 h-10 w-10 rounded-full ${s&&"type"in s?s.type==="income"?" bg-green-500":s.type==="expense"?" bg-red-500":" bg-gray-500 dark:bg-secondary":""} flex items-center justify-center`,children:e.jsx("i",{className:` text-white fa-solid ${s&&"type"in s?s.type==="income"?"fa-right-to-bracket rotate-90":s.type==="expense"?"fa-right-from-bracket -rotate-90":"fa-right-left rotate-90":""}`})}),e.jsxs("div",{className:" w-full flex flex-col overflow-hidden",children:[e.jsx("span",{className:" whitespace-nowrap overflow-hidden text-ellipsis font-medium",children:(()=>s&&"category_id"in s&&s.category?e.jsx(e.Fragment,{children:`${s.category.parent?`${s.category.parent.name} - `:""}${s.category.name}`}):e.jsx(e.Fragment,{children:"Uncategorized"}))()}),e.jsx("span",{className:" whitespace-nowrap text-sm overflow-hidden text-ellipsis",children:s&&"name"in s?s.name:"Planned Name"})]})]}),e.jsxs("div",{className:" mt-4 flex flex-row gap-4",children:[(()=>document.getElementById("plannedRecordSkipDialog-section")?e.jsx(h,{className:"w-full",variant:"outline",onClick:()=>{document.dispatchEvent(new CustomEvent("planned-payment.record.skip",{bubbles:!0,detail:{uuid:s==null?void 0:s.uuid}}))},children:e.jsx("span",{className:" text-red-500",children:"Skip"})}):e.jsx(e.Fragment,{}))(),e.jsx(h,{className:"w-full",onClick:c=>{let i=c.target;if(i){let f=i.innerHTML;i.innerHTML='<span class=" flex items-center gap-1"><i class="fa-solid fa-spinner fa-spin-pulse"></i>Loading</span>';const D=()=>{f&&(i.innerHTML=f),document.removeEventListener("dialog.record.shown",D)};document.addEventListener("dialog.record.shown",D)}document.dispatchEvent(new CustomEvent("record-dialog.planned-payment.confirmation",{bubbles:!0,detail:{uuid:s&&"uuid"in s?s.uuid:null}}))},children:"Confirm"})]})]})})},"planned_prompt-0")),o&&o.length>0&&o.map((c,i)=>{t.push(e.jsx("div",{children:O(c)},`planned_item-${i}`))}),t.length>0?t:d}})()]}),e.jsx(xe,{children:e.jsx("div",{children:e.jsx(h,{variant:"outline",className:"dark:border-white",disabled:!R,onClick:()=>{E(!1),Y(C+p)},children:"Load more"})})})]})]})]})})}export{Se as default};
