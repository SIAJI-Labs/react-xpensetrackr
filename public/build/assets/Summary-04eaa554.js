import{r as n,j as e,d as A,e as g}from"./app-49aea280.js";import{m as l,f as k}from"./Combination-57e7aa50.js";import{N as F}from"./NoDataTemplate-cba6ec0f.js";import{D as O,a as B,b as L,c as q}from"./dropdown-menu-e7c91c18.js";import{B as d,u as y}from"./button-0487a8c3.js";import{S as o}from"./skeleton-8d118e4f.js";function z({plannedPayment:s,period:u}){let p=(Math.random()+1).toString(36).substring(7);const[f,x]=n.useState(!1);return console.log(s),e.jsx("section",{onClick:w=>{x(!0)},children:e.jsxs("div",{className:" flex flex-col gap-2 border rounded p-4 cursor-pointer",children:[e.jsxs("div",{className:" flex flex-row gap-6 justify-between",children:[e.jsx("span",{className:" whitespace-nowrap overflow-hidden overflow-ellipsis font-semibold",children:s&&s?`${s.parent?`${s.parent.name} - `:""}${s==null?void 0:s.name}`:"Wallet Name"}),e.jsx("div",{children:e.jsxs(O,{open:f,onOpenChange:x,children:[e.jsx(B,{asChild:!0,children:e.jsx(d,{variant:"link",className:" p-0 h-auto leading-none dark:!text-white !text-black","data-type":"dropdown-trigger",children:e.jsx("i",{className:"fa-solid fa-ellipsis-vertical"})})}),e.jsx(L,{sideOffset:5,alignOffset:0,side:"left",align:"start",children:e.jsx(A,{href:s?route("sys.planned-payment.summary.show",{wallet:s.uuid,period:u!==void 0?l(u).format("YYYY-MM"):null}):"#",children:e.jsx(q,{className:" cursor-pointer",children:e.jsx("span",{className:" text-blue-500",children:"Detail"})})})})]})})]}),e.jsx("hr",{}),e.jsxs("div",{className:" flex flex-col gap-1",children:[e.jsxs("div",{className:" flex flex-row justify-between",children:[e.jsxs("span",{children:[s&&s.expected_planned_income?s.expected_planned_income.length:0," expected Income"]}),e.jsx("span",{className:"text-green-500",children:k(s&&s.expected_income?s.expected_income:0)})]}),e.jsxs("div",{className:" flex flex-row justify-between",children:[e.jsxs("span",{children:[s&&s.expected_planned_income?s.expected_planned_expense.length:0," expected Expense"]}),e.jsx("span",{className:"text-red-500",children:k(s&&s.expected_expense?s.expected_expense:0)})]})]})]})},p)}function U(){let s=(Math.random()+1).toString(36).substring(7);return e.jsx("section",{children:e.jsxs("div",{className:" flex flex-col gap-2 border rounded p-4 cursor-pointer",children:[e.jsxs("div",{className:" flex flex-row gap-6 justify-between",children:[e.jsx(o,{className:"h-4 w-40"}),e.jsx(o,{className:"h-4 w-2"})]}),e.jsxs("div",{className:" mt-2 flex flex-col gap-2",children:[e.jsx(o,{className:"h-1 w-full"}),e.jsxs("div",{className:"flex flex-row justify-between",children:[e.jsxs("div",{className:" flex flex-row gap-2",children:[e.jsx(o,{className:" h-4 w-4"}),e.jsx(o,{className:" h-4 w-20"})]}),e.jsx(o,{className:" h-4 w-6"})]}),e.jsxs("div",{className:"flex flex-row justify-between",children:[e.jsxs("div",{className:" flex flex-row gap-2",children:[e.jsx(o,{className:" h-4 w-4"}),e.jsx(o,{className:" h-4 w-20"})]}),e.jsx(o,{className:" h-4 w-6"})]})]})]})},s)}function X({auth:s,activeType:u}){const p=y();n.useEffect(()=>{Y()},[]);const[f,x]=n.useState(null),[w,N]=n.useState(!0),[i,C]=n.useState();let v=5;const[h,D]=n.useState(v),[_,b]=n.useState(!1),Y=async()=>{N(!0),f instanceof AbortController&&f.abort();const t=new AbortController;x(t);const r=[],m={filter_period:l(c).format("YYYY-MM-DD"),filter_period_timezone:l.tz.guess(),limit:h};for(const a in m)r.push(encodeURIComponent(a)+"="+encodeURIComponent(m[a]));try{let M=(await g.get(`${route("api.planned-payment.summary.v1.list")}?${r.join("&")}`,{cancelToken:new g.CancelToken(function(T){t.abort=T})})).data;C(M.result.data),b(M.result.has_more),N(!1),x(null)}catch(a){g.isCancel(a)?console.log("Request was canceled",a):console.error("Error:",a)}};let I=t=>e.jsx(z,{plannedPayment:t,period:l(c).toDate()});const[E,R]=n.useState(5);let $=()=>e.jsx(U,{});n.useEffect(()=>{i&&R(i.length>0?i.length:3)},[i]);const[c,S]=n.useState();if(c===void 0){let t=l();S(l(t).toDate())}const j=(t="prev")=>{let r=l(c);t==="prev"?r=l(r).subtract(1,"months"):t==="next"?r=l(r).add(1,"months"):t==="current"&&(r=l()),S(l(r).toDate())};return n.useEffect(()=>{p||Y()},[h,c]),e.jsx(e.Fragment,{children:e.jsxs("div",{className:"flex flex-col gap-6",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsxs("div",{className:" flex justify-between items-center",children:[e.jsx(d,{variant:"ghost",onClick:()=>{j("prev")},children:e.jsx("span",{children:e.jsx("i",{className:"fa-solid fa-angle-left"})})}),e.jsx("div",{className:"flex flex-col",children:e.jsx(d,{variant:"outline",className:"px-6",children:l(c).format("MMMM, YYYY")})}),e.jsx(d,{variant:"ghost",onClick:()=>{j("next")},children:e.jsx("span",{children:e.jsx("i",{className:"fa-solid fa-angle-right"})})})]}),(()=>l().format("YYYY-MM-DD")!=l(c).format("YYYY-MM-DD")?e.jsxs(d,{variant:"link",className:"py-0",onClick:()=>{j("current")},children:["Back to current period (",l().format("MMM, YYYY"),")"]}):e.jsx(e.Fragment,{}))()]}),(()=>{if(w){let t=[];for(let r=0;r<E;r++)t.push(e.jsx("div",{children:$()},`skeleton-${r}`));return t}else{let t=[],r=e.jsx(F,{});return i&&i.length>0&&i.map((m,a)=>{t.push(e.jsx("div",{children:I(m)},`planned_item-${a}`))}),t.length>0?t:r}})(),e.jsx("div",{children:e.jsx(d,{variant:"outline",className:"dark:border-white",disabled:!_,onClick:()=>{b(!1),D(h+v)},children:"Load more"})})]})})}export{X as default};
