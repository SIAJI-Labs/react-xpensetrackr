import{r,j as e,d as y,e as v}from"./app-a527d074.js";import{a as l,f as M}from"./function-c3ea43bf.js";import{D as A,a as L,b as B,c as F,T as O}from"./TemplateNoData-aedb4fde.js";import{B as d,u as q}from"./button-ae8c2129.js";import{S as o}from"./skeleton-b2e348e4.js";/* empty css            */function z({plannedPayment:s,period:p}){let f=(Math.random()+1).toString(36).substring(7);const[m,x]=r.useState(!1);return e.jsx("section",{onClick:w=>{x(!0)},children:e.jsxs("div",{className:" flex flex-col gap-2 border rounded p-4 cursor-pointer",children:[e.jsxs("div",{className:" flex flex-row gap-6 justify-between",children:[e.jsx("span",{className:" whitespace-nowrap overflow-hidden overflow-ellipsis font-semibold",children:s&&s?`${s.parent?`${s.parent.name} - `:""}${s==null?void 0:s.name}`:"Wallet Name"}),e.jsx("div",{children:e.jsxs(A,{open:m,onOpenChange:x,children:[e.jsx(L,{asChild:!0,children:e.jsx(d,{variant:"link",className:" p-0 h-auto leading-none dark:!text-white !text-black","data-type":"dropdown-trigger",children:e.jsx("i",{className:"fa-solid fa-ellipsis-vertical"})})}),e.jsx(B,{sideOffset:5,alignOffset:0,side:"left",align:"start",children:e.jsx(y,{href:s?route("sys.planned-payment.summary.show",{wallet:s.uuid,period:p!==void 0?l(p).format("YYYY-MM"):null}):"#",children:e.jsx(F,{className:" cursor-pointer",children:e.jsx("span",{className:" text-blue-500",children:"Detail"})})})})]})})]}),e.jsx("hr",{}),e.jsxs("div",{className:" flex flex-col gap-1",children:[e.jsxs("div",{className:" flex flex-row justify-between",children:[e.jsxs("span",{children:[s&&s.expected_planned_income?s.expected_planned_income.length:0," expected Income"]}),e.jsx("span",{className:"text-green-500",children:M(s&&s.expected_income?s.expected_income:0)})]}),e.jsxs("div",{className:" flex flex-row justify-between",children:[e.jsxs("span",{children:[s&&s.expected_planned_income?s.expected_planned_expense.length:0," expected Expense"]}),e.jsx("span",{className:"text-red-500",children:M(s&&s.expected_expense?s.expected_expense:0)})]})]})]})},f)}function U(){let s=(Math.random()+1).toString(36).substring(7);return e.jsx("section",{children:e.jsxs("div",{className:" flex flex-col gap-2 border rounded p-4 cursor-pointer",children:[e.jsxs("div",{className:" flex flex-row gap-6 justify-between",children:[e.jsx(o,{className:"h-4 w-40"}),e.jsx(o,{className:"h-4 w-2"})]}),e.jsxs("div",{className:" mt-2 flex flex-col gap-2",children:[e.jsx(o,{className:"h-1 w-full"}),e.jsxs("div",{className:"flex flex-row justify-between",children:[e.jsxs("div",{className:" flex flex-row gap-2",children:[e.jsx(o,{className:" h-4 w-4"}),e.jsx(o,{className:" h-4 w-20"})]}),e.jsx(o,{className:" h-4 w-6"})]}),e.jsxs("div",{className:"flex flex-row justify-between",children:[e.jsxs("div",{className:" flex flex-row gap-2",children:[e.jsx(o,{className:" h-4 w-4"}),e.jsx(o,{className:" h-4 w-20"})]}),e.jsx(o,{className:" h-4 w-6"})]})]})]})},s)}function X({auth:s,activeType:p}){const f=q();r.useEffect(()=>{j()},[]);const[m,x]=r.useState(null),[w,N]=r.useState(!0),[i,k]=r.useState();let b=5;const[h,D]=r.useState(b),[_,Y]=r.useState(!1),j=async()=>{N(!0),m instanceof AbortController&&m.abort();const t=new AbortController;x(t);const n=[],u={filter_period:l(c).format("YYYY-MM-DD"),filter_period_timezone:l.tz.guess(),limit:h};for(const a in u)n.push(encodeURIComponent(a)+"="+encodeURIComponent(u[a]));try{let C=(await v.get(`${route("api.planned-payment.summary.v1.list")}?${n.join("&")}`,{cancelToken:new v.CancelToken(function($){t.abort=$})})).data;k(C.result.data),Y(C.result.has_more),N(!1),x(null)}catch(a){v.isCancel(a)?console.log("Request was canceled",a):console.error("Error:",a)}};let E=t=>e.jsx(z,{plannedPayment:t,period:l(c).toDate()});const[I,T]=r.useState(5);let R=()=>e.jsx(U,{});r.useEffect(()=>{i&&T(i.length>0?i.length:3)},[i]);const[c,S]=r.useState();if(c===void 0){let t=l();S(l(t).toDate())}const g=(t="prev")=>{let n=l(c);t==="prev"?n=l(n).subtract(1,"months"):t==="next"?n=l(n).add(1,"months"):t==="current"&&(n=l()),S(l(n).toDate())};return r.useEffect(()=>{f||j()},[h,c]),r.useEffect(()=>{if(!f){const t=()=>{console.log("ABC"),setTimeout(()=>{j()},100)};return document.addEventListener("planned-payment.refresh",t),()=>{document.removeEventListener("planned-payment.refresh",t)}}}),e.jsx(e.Fragment,{children:e.jsxs("div",{className:"flex flex-col gap-6",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsxs("div",{className:" flex justify-between items-center",children:[e.jsx(d,{variant:"ghost",onClick:()=>{g("prev")},children:e.jsx("span",{children:e.jsx("i",{className:"fa-solid fa-angle-left"})})}),e.jsx("div",{className:"flex flex-col",children:e.jsx(d,{variant:"outline",className:"px-6",children:l(c).format("MMMM, YYYY")})}),e.jsx(d,{variant:"ghost",onClick:()=>{g("next")},children:e.jsx("span",{children:e.jsx("i",{className:"fa-solid fa-angle-right"})})})]}),(()=>l().format("YYYY-MM-DD")!=l(c).format("YYYY-MM-DD")?e.jsxs(d,{variant:"link",className:"py-0",onClick:()=>{g("current")},children:["Back to current period (",l().format("MMM, YYYY"),")"]}):e.jsx(e.Fragment,{}))()]}),e.jsx("div",{className:" flex flex-col gap-4",children:(()=>{if(w){let t=[];for(let n=0;n<I;n++)t.push(e.jsx("div",{children:R()},`skeleton-${n}`));return t}else{let t=[],n=e.jsx(O,{});return i&&i.length>0&&i.map((u,a)=>{t.push(e.jsx("div",{children:E(u)},`planned_item-${a}`))}),t.length>0?t:n}})()}),e.jsx("div",{children:e.jsx(d,{variant:"outline",className:"dark:border-white",disabled:!_,onClick:()=>{Y(!1),D(h+b)},children:"Load more"})})]})})}export{X as default};
