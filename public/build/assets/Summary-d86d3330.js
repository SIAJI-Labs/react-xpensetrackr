import{r,j as e,d as $,e as v}from"./app-25e70858.js";import{B as d,u as A}from"./button-3a8be072.js";import{a as l,f as C}from"./function-0c5d2c61.js";import{D as y,a as L,b as B,c as F,T as O}from"./TemplateNoData-3f80188f.js";import{S as o}from"./skeleton-1d1f3ace.js";/* empty css            */function q({plannedPayment:s,period:x}){let f=(Math.random()+1).toString(36).substring(7);const[m,u]=r.useState(!1);return e.jsx("section",{onClick:h=>{u(!0)},children:e.jsxs("div",{className:" flex flex-col gap-2 border rounded p-4 cursor-pointer",children:[e.jsxs("div",{className:" flex flex-row gap-6 justify-between",children:[e.jsx("span",{className:" whitespace-nowrap overflow-hidden overflow-ellipsis font-semibold",children:s&&s?`${s.parent?`${s.parent.name} - `:""}${s==null?void 0:s.name}`:"Wallet Name"}),e.jsx("div",{children:e.jsxs(y,{open:m,onOpenChange:u,children:[e.jsx(L,{asChild:!0,children:e.jsx(d,{variant:"link",className:" p-0 h-auto leading-none dark:!text-white !text-black","data-type":"dropdown-trigger",children:e.jsx("i",{className:"fa-solid fa-ellipsis-vertical"})})}),e.jsx(B,{sideOffset:5,alignOffset:0,side:"left",align:"start",children:e.jsx($,{href:s?route("sys.planned-payment.summary.show",{wallet:s.uuid,period:x!==void 0?l(x).format("YYYY-MM"):null}):"#",children:e.jsx(F,{className:" cursor-pointer",children:e.jsx("span",{className:" text-blue-500",children:"Detail"})})})})]})})]}),e.jsx("hr",{}),e.jsxs("div",{className:" flex flex-col gap-1",children:[e.jsxs("div",{className:" flex flex-row justify-between",children:[e.jsxs("span",{children:[s&&s.expected_planned_income?s.expected_planned_income.length:0," expected Income"]}),e.jsx("span",{className:"text-green-500",children:C(s&&s.expected_income?s.expected_income:0)})]}),e.jsxs("div",{className:" flex flex-row justify-between",children:[e.jsxs("span",{children:[s&&s.expected_planned_income?s.expected_planned_expense.length:0," expected Expense"]}),e.jsx("span",{className:"text-red-500",children:C(s&&s.expected_expense?s.expected_expense:0)})]})]})]})},f)}function z(){let s=(Math.random()+1).toString(36).substring(7);return e.jsx("section",{children:e.jsxs("div",{className:" flex flex-col gap-2 border rounded p-4 cursor-pointer",children:[e.jsxs("div",{className:" flex flex-row gap-6 justify-between",children:[e.jsx(o,{className:"h-4 w-40"}),e.jsx(o,{className:"h-4 w-2"})]}),e.jsxs("div",{className:" mt-2 flex flex-col gap-2",children:[e.jsx(o,{className:"h-1 w-full"}),e.jsxs("div",{className:"flex flex-row justify-between",children:[e.jsxs("div",{className:" flex flex-row gap-2",children:[e.jsx(o,{className:" h-4 w-4"}),e.jsx(o,{className:" h-4 w-20"})]}),e.jsx(o,{className:" h-4 w-6"})]}),e.jsxs("div",{className:"flex flex-row justify-between",children:[e.jsxs("div",{className:" flex flex-row gap-2",children:[e.jsx(o,{className:" h-4 w-4"}),e.jsx(o,{className:" h-4 w-20"})]}),e.jsx(o,{className:" h-4 w-6"})]})]})]})},s)}function V({auth:s}){const x=A();r.useEffect(()=>{g()},[]);const[f,m]=r.useState(null),[u,h]=r.useState(!0),[i,M]=r.useState();let N=5;const[j,k]=r.useState(N),[D,b]=r.useState(!1),g=async()=>{h(!0),f instanceof AbortController&&f.abort();const t=new AbortController;m(t);const n=[],p={filter_period:l(c).format("YYYY-MM-DD"),filter_period_timezone:l.tz.guess(),limit:j};for(const a in p)n.push(encodeURIComponent(a)+"="+encodeURIComponent(p[a]));try{let S=(await v.get(`${route("api.planned-payment.summary.v1.list")}?${n.join("&")}`,{cancelToken:new v.CancelToken(function(T){t.abort=T})})).data;M(S.result.data),b(S.result.has_more),h(!1),m(null)}catch(a){v.isCancel(a)?console.log("Request was canceled",a):console.error("Error:",a)}};let _=t=>e.jsx(q,{plannedPayment:t,period:l(c).toDate()});const[E,I]=r.useState(5);let R=()=>e.jsx(z,{});r.useEffect(()=>{i&&I(i.length>0?i.length:3)},[i]);const[c,Y]=r.useState();if(c===void 0){let t=l();Y(l(t).toDate())}const w=(t="prev")=>{let n=l(c);t==="prev"?n=l(n).subtract(1,"months"):t==="next"?n=l(n).add(1,"months"):t==="current"&&(n=l()),Y(l(n).toDate())};return r.useEffect(()=>{x||g()},[j,c]),r.useEffect(()=>{if(!x){const t=()=>{console.log("ABC"),setTimeout(()=>{g()},100)};return document.addEventListener("planned-payment.refresh",t),()=>{document.removeEventListener("planned-payment.refresh",t)}}}),e.jsx(e.Fragment,{children:e.jsxs("div",{className:"flex flex-col gap-6",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsxs("div",{className:" flex justify-between items-center",children:[e.jsx(d,{variant:"ghost",onClick:()=>{w("prev")},children:e.jsx("span",{children:e.jsx("i",{className:"fa-solid fa-angle-left"})})}),e.jsx("div",{className:"flex flex-col",children:e.jsx(d,{variant:"outline",className:"px-6",children:l(c).format("MMMM, YYYY")})}),e.jsx(d,{variant:"ghost",onClick:()=>{w("next")},children:e.jsx("span",{children:e.jsx("i",{className:"fa-solid fa-angle-right"})})})]}),(()=>l().format("YYYY-MM-DD")!=l(c).format("YYYY-MM-DD")?e.jsxs(d,{variant:"link",className:"py-0",onClick:()=>{w("current")},children:["Back to current period (",l().format("MMM, YYYY"),")"]}):e.jsx(e.Fragment,{}))()]}),e.jsx("div",{className:" flex flex-col gap-4",children:(()=>{if(u){let t=[];for(let n=0;n<E;n++)t.push(e.jsx("div",{children:R()},`skeleton-${n}`));return t}else{let t=[],n=e.jsx(O,{});return i&&i.length>0&&i.map((p,a)=>{t.push(e.jsx("div",{children:_(p)},`planned_item-${a}`))}),t.length>0?t:n}})()}),e.jsx("div",{children:e.jsx(d,{variant:"outline",className:"dark:border-white",disabled:!D,onClick:()=>{b(!1),k(j+N)},children:"Load more"})})]})})}export{V as default};
